var TcHmi,__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(receiver,state,kind,f){if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===kind?f:"a"===kind?f.call(receiver):f?f.value:state.get(receiver)};!function(TcHmi){!function(Controls){!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl_1){var _a,_TcHmiScopeControl_tchmiFQN;class TcHmiScopeControl extends TcHmi.Controls.System.TcHmiControl{constructor(element,pcElement,attrs){super(element,pcElement,attrs),this.__localizedElements=new Map,this.__localizationReader=void 0,this.__destroyLocalizationWatch=null,this.__isInitialized=!1,this.__showLegend=!0,this.__scaling={x:1,y:1},this.__lineCharts=[],this.__overviewChart=null,this.__chartingElements=[],this.__toolBarControls={},this.__toolBarControlsArray=[],this.__timeBarControls={},this.__initEventDestroyEvent=null,this.__resizeEventDestroyEvent=null,this.__themeDataLoadedEventDestroyEvent=null,this.__userDataChangedEventDestroyEvent=null,this.__scopeEventsDestroyEvent=null,this.__configEventsDestroyEvent=null,this.__subscriptionIdOnExtensionStateChanged=null,this.__initRequestId=null,this.__openConnectionRequestId=null,this.__subscriptionIdMenubar=null,this.__setChartSizeRequestId=null,this.__subscriptionId=null,this.__subscriptionIdActualWindow=null,this.__startRecordRequestId=null,this.__startRequestId=null,this.__stopRecordRequestId=null,this.__stopRequestId=null,this.__zoomRequestId=null,this.__panRequestId=null,this.__wheelRequestId=null,this.__unzoomRequestId=null,this.__zoomOutRequestId=null,this.__displayWidthRequestId=null,this.__gotoRequestId=null,this.__scrollRequestId=null,this.__scrollBigRequestId=null,this.__undoRequestId=null,this.__redoRequestId=null,this.__setOverviewModeRequestId=null,this.__setOverviewRectRequestId=null,this.__getTooltipRequestId=null,this.__resizeChartsRequestId=null,this.__changeChannelStateRequestId=null,this.__tooltipTimeout=null,this.__scopeGraphWindow=null,this.__enabledButtons=TcHmiScopeControl.ButtonsEnabled.None,this.__enabledTimes=TcHmiScopeControl.TimesEnabled.None,this.__sessionId=null,this.__socketId=null,this.__mouseMode=null,this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0},this.__multitouchInfo={multitouchMode:!1,first:{identifier:null,startPoint:{x:0,y:0}},second:{identifier:null,startPoint:{x:0,y:0}},offset:{left:0,top:0},distance:0,elementIndex:-1,middlePoint:{x:0,y:0}},this.__wheelInfo={isWheeling:!1,wheelSteps:0,mousePosition:{x:0,y:0},timeout:0},this.__resizeLines=[],this.__destroyEvents={},this.__themeChartBackgroundColor=null,this.__themeChartForegroundColor=null,this.__themeOverviewBackgroundColor=null,this.__themeOverviewForegroundColor=null,this.__themeCanvasBackgroundColor=null,this.__themeAxisColor=null,this.__themeGridColor=null,this.__overviewRectangle={position:{x:0,y:0},dimensions:{width:0,height:0}},this.__loadingSpinner=null,this.__onCheckboxMouseDown=event=>{if(!this.getIsEnabled()||1!==event.which)return;let childElement=event.target,checkboxElem=null;if("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox"===childElement.className)checkboxElem=childElement;else if("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-label"===childElement.className){let checkboxList=childElement.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");checkboxList&&checkboxList.length>0&&(checkboxElem=checkboxList[0])}else if("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-color-element"===childElement.className&&childElement&&childElement.parentElement){let checkboxList=childElement.parentElement.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");checkboxList&&checkboxList.length>0&&(checkboxElem=checkboxList[0])}if(checkboxElem){let id=checkboxElem.id,checked=!checkboxElem.checked;if(!TcHmi.Access.checkAccess(this,"operate"))return void(checkboxElem.checked=checked);this.changeChannelState(id,checked)}},this.__onCheckboxTouchStart=event=>{if(!this.getIsEnabled())return;let childElement=event.target;if(childElement){let checkboxList=childElement.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");if(checkboxList&&checkboxList.length>0){let checkoboxElement=checkboxList[0],id=checkoboxElement.id,checked=!checkoboxElement.checked;if(!TcHmi.Access.checkAccess(this,"operate"))return void(checkoboxElement.checked=checked);this.changeChannelState(id,checked)}}},this.__onResolverForScopeConfigWatchCallback=data=>{!1===this.__isAttached&&data.destroy&&this.__suspendObjectResolver("scopeConfig"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__scopeConfig)||(this.__scopeConfig=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ScopeConfig"}),this.__processScopeConfig()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+this.getId()+", Attribute=ScopeConfig] Resolving symbols from object faield with error: "+TcHmi.Log.buildMessage(data.details))},this.__mousedownHandler=this.__onMouseDown(),this.__mousedownGlobalHandler=this.__onMouseDownGlobal(),this.__mouseupHandler=this.__onMouseUp(),this.__mousemoveHandler=this.__onMouseMove(),this.__mousemoveChangeCursorHandler=this.__onMouseMoveChangeCursor(),this.__mousemoveOverviewHandler=this.__onMouseMoveOverview(),this.__touchstartHandler=this.__onTouchStart(),this.__touchmoveHandler=this.__onTouchMove(),this.__touchendHandler=this.__onTouchEnd(),this.__mousewheelHandler=this.__onMouseWheel()}__previnit(){if(this.__elementTemplateRoot=this.__element.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template"),this.__elementChartings=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chartings"),this.__elementBorder=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-border"),this.__elementOverview=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-overview"),this.__elementChartName=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart-name"),this.__elementMenuBar=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar"),this.__elementTimeBar=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-time-bar"),this.__elementToolBar=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-tool-bar"),this.__elementMenuBarDropdown=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-dropdown tchmi-box"><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-bar-dropdown tchmi-box"></div><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tool-bar-dropdown tchmi-box"></div></div>'),this.__elementLegend=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend"),this.__elementLoading=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-loading"),this.__elementTooltip=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip"),this.__elementTooltipText=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-text"),this.__elementTooltipArrow=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow"),0===this.__elementTemplateRoot.length||0===this.__elementChartings.length||0===this.__elementBorder.length||0===this.__elementOverview.length||0===this.__elementChartName.length||0===this.__elementMenuBar.length||0===this.__elementTimeBar.length||0===this.__elementToolBar.length||0===this.__elementMenuBarDropdown.length||0===this.__elementLegend.length||0===this.__elementLoading.length||0===this.__elementTooltip.length||0===this.__elementTooltipText.length||0===this.__elementTooltipArrow.length)throw new Error("Invalid Template.html");let loadingSpinnerDivTempDiv=document.createElement("div");loadingSpinnerDivTempDiv.innerHTML='<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-loading-spinner-container"><div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-loading-spinner"><div></div><div></div><div></div><div></div></div></div>',this.__loadingSpinner=loadingSpinnerDivTempDiv.firstElementChild;let localizedElements=this.__element[0].querySelectorAll("[data-tchmi-localized-content-key]");for(let i=0,ii=localizedElements.length;i<ii;i++){let element=localizedElements[i],localizeKey=element.dataset.tchmiLocalizedContentKey;localizeKey&&this.__localizedElements.set(localizeKey,{element:element,value:""})}this.__destroyLocalizationWatch=this.__localization.watch(data=>{if(data.error===TcHmi.Errors.NONE&&data.reader){this.__localizationReader=data.reader;for(const[key,info]of this.__localizedElements){let localizedText=data.reader.get(key);if(-1!==key.indexOf("Tooltip"))info.element.title=tchmi_decode_control_characters(localizedText);else if(null!==info.value)if(-1!==info.value.indexOf("Label_Text_Date_Placeholder")){let valueLocalization=this.__localizationReader.get("Label_Text_Date_Placeholder");info.element.textContent=tchmi_decode_control_characters(localizedText+": "+valueLocalization)}else info.element.textContent=tchmi_decode_control_characters(localizedText+": "+info.value);else info.element.textContent=tchmi_decode_control_characters(localizedText)}}}),super.__previnit()}__init(){if(super.__init(),this.__elementLegend[0].addEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementLegend[0].addEventListener("touchstart",this.__onCheckboxTouchStart),this.__loadThemedResources(),!TCHMI_ENABLE_DESIGNER_MODE_MASTER){if(this.__serverDomain){this.__configEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload::configType",comparator:">=",value:0}],{subscription:this.__configEventCallback()});let symbol="ListDomains::"+this.__serverDomain+"::state";this.__subscriptionIdOnExtensionStateChanged=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbol}],300,this.__onExtensionStateChanged())}let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Init",writeValue:{controlName:this.__id}}]};TcHmi.Server.releaseRequest(this.__initRequestId),this.__initRequestId=TcHmi.Server.requestEx(request,null,this.__initCallback())}}__clearInit(){null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId,null),this.__subscriptionId=null),null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar,null),this.__subscriptionIdMenubar=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow,null),this.__subscriptionIdActualWindow=null),null!==this.__scopeEventsDestroyEvent&&(this.__scopeEventsDestroyEvent(),this.__scopeEventsDestroyEvent=null),this.__sessionId=null,this.__socketId=null,this.__isInitialized=!1;let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Init",writeValue:{controlName:this.__id}}]};TcHmi.Server.releaseRequest(this.__initRequestId),this.__initRequestId=TcHmi.Server.requestEx(request,null,this.__initCallback()),this.__openWebsocket()}__initCallback(){let __this=this;return function(result){var _b;if(!__this.__isDestroyed&&null!==__this.__initRequestId)if(__this.__initRequestId=null,result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return null!==result.response.commands&&void 0!==result.response.commands&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Server responds with error. Details: "+TcHmi.Log.buildMessage(result.response.error)),void(__this.__loadingSpinner&&__this.__loadingSpinner.remove());if(null!==result.response.commands&&void 0!==result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error&&130!==result.response.commands[i].error.code)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`),__this.__loadingSpinner&&__this.__loadingSpinner.remove(),void __this.__clearFullControl();if(result.response.commands[i].symbol===__this.__serverDomain+".Init"){let sessionId=result.response.sessionId,socketId=null===(_b=result.response.commands[i].readValue)||void 0===_b?void 0:_b.socketId;sessionId&&socketId&&__this.__serverDomain&&(__this.__sessionId=sessionId,__this.__socketId=socketId,__this.__scopeEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:__this.__serverDomain},{logic:"AND"},{path:"payload::sessionId",comparator:"==",value:__this.__sessionId},{logic:"AND"},{path:"payload::socketId",comparator:"==",value:__this.__socketId}],{subscription:__this.__scopeEventCallback()},__this.__eventRegisterDoneCallback()))}}}else __this.__loadingSpinner&&__this.__loadingSpinner.remove(),result.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Framework error= "+result.error+", name="+TcHmi.Errors[result.error]+" while fetching data from server.")}}__eventRegisterDoneCallback(){let __this=this;return function(data){data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Error registering the scope event consumer. Details: ${data.error} IMPORTANT: No scope events are logged now. All messages and errors are displayed on the server log page. `),__this.__isInitialized=!0,TcHmi.EventProvider.raise(__this.__id+".onInitChanged")}}__initChanged(){return evt=>{null!==this.__initEventDestroyEvent&&(this.__initEventDestroyEvent(),this.__initEventDestroyEvent=null),this.__openConnection()}}__attach(){super.__attach(),!TCHMI_DESIGNER&&this.__serverDomain&&this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),TCHMI_DESIGNER||(this.__resizeEventDestroyEvent=TcHmi.EventProvider.register(this.__id+".onResized",this.__rebuild()),this.__themeDataLoadedEventDestroyEvent=TcHmi.EventProvider.register("onThemeDataChanged",this.__onThemeDataChanged()),this.__userDataChangedEventDestroyEvent=TcHmi.EventProvider.register("onUserDataChanged",this.__onUserDataChanged()));const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};document.addEventListener("mousedown",this.__mousedownGlobalHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),document.addEventListener("mousemove",this.__mousemoveHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),document.addEventListener("mouseup",this.__mouseupHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),this.__element[0].addEventListener("mousemove",this.__mousemoveChangeCursorHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),document.addEventListener("touchmove",this.__touchmoveHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),document.addEventListener("touchend",this.__touchendHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),this.__openWebsocket()}__detach(){super.__detach(),null!==this.__initEventDestroyEvent&&(this.__initEventDestroyEvent(),this.__initEventDestroyEvent=null),null!==this.__resizeEventDestroyEvent&&(this.__resizeEventDestroyEvent(),this.__resizeEventDestroyEvent=null),null!==this.__themeDataLoadedEventDestroyEvent&&(this.__themeDataLoadedEventDestroyEvent(),this.__themeDataLoadedEventDestroyEvent=null),null!==this.__userDataChangedEventDestroyEvent&&(this.__userDataChangedEventDestroyEvent(),this.__userDataChangedEventDestroyEvent=null),null!==this.__scopeEventsDestroyEvent&&(this.__scopeEventsDestroyEvent(),this.__scopeEventsDestroyEvent=null),null!==this.__startRecordRequestId&&(TcHmi.Server.releaseRequest(this.__startRecordRequestId),this.__startRecordRequestId=null),null!==this.__startRequestId&&(TcHmi.Server.releaseRequest(this.__startRequestId),this.__startRequestId=null),null!==this.__stopRecordRequestId&&(TcHmi.Server.releaseRequest(this.__stopRecordRequestId),this.__stopRecordRequestId=null),null!==this.__stopRequestId&&(TcHmi.Server.releaseRequest(this.__stopRequestId),this.__stopRequestId=null),null!==this.__zoomRequestId&&(TcHmi.Server.releaseRequest(this.__zoomRequestId),this.__zoomRequestId=null),null!==this.__panRequestId&&(TcHmi.Server.releaseRequest(this.__panRequestId),this.__panRequestId=null),null!==this.__wheelRequestId&&(TcHmi.Server.releaseRequest(this.__wheelRequestId),this.__wheelRequestId=null),null!==this.__unzoomRequestId&&(TcHmi.Server.releaseRequest(this.__unzoomRequestId),this.__unzoomRequestId=null),null!==this.__zoomOutRequestId&&(TcHmi.Server.releaseRequest(this.__zoomOutRequestId),this.__zoomOutRequestId=null),null!==this.__displayWidthRequestId&&(TcHmi.Server.releaseRequest(this.__displayWidthRequestId),this.__displayWidthRequestId=null),null!==this.__gotoRequestId&&(TcHmi.Server.releaseRequest(this.__gotoRequestId),this.__gotoRequestId=null),null!==this.__scrollRequestId&&(TcHmi.Server.releaseRequest(this.__scrollRequestId),this.__scrollRequestId=null),null!==this.__scrollBigRequestId&&(TcHmi.Server.releaseRequest(this.__scrollBigRequestId),this.__scrollBigRequestId=null),null!==this.__undoRequestId&&(TcHmi.Server.releaseRequest(this.__undoRequestId),this.__undoRequestId=null),null!==this.__redoRequestId&&(TcHmi.Server.releaseRequest(this.__redoRequestId),this.__redoRequestId=null),null!==this.__setOverviewModeRequestId&&(TcHmi.Server.releaseRequest(this.__setOverviewModeRequestId),this.__setOverviewModeRequestId=null),null!==this.__setOverviewRectRequestId&&(TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=null),null!==this.__getTooltipRequestId&&(TcHmi.Server.releaseRequest(this.__getTooltipRequestId),this.__getTooltipRequestId=null),null!==this.__resizeChartsRequestId&&(TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=null),null!==this.__changeChannelStateRequestId&&(TcHmi.Server.releaseRequest(this.__changeChannelStateRequestId),this.__changeChannelStateRequestId=null);const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};document.removeEventListener("mousedown",this.__mousedownGlobalHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),document.removeEventListener("mousemove",this.__mousemoveHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),document.removeEventListener("mouseup",this.__mouseupHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),this.__element[0].removeEventListener("mousemove",this.__mousemoveChangeCursorHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),document.removeEventListener("touchmove",this.__touchmoveHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),document.removeEventListener("touchend",this.__touchendHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId,null),this.__subscriptionId=null),null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar,null),this.__subscriptionIdMenubar=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow,null),this.__subscriptionIdActualWindow=null);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".DetachControl",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};TcHmi.Server.request(request)}destroy(){var _b;if(this.__keepAlive)return;super.destroy(),null!==this.__subscriptionIdOnExtensionStateChanged&&(TcHmi.Server.unsubscribe(this.__subscriptionIdOnExtensionStateChanged,null),this.__subscriptionIdOnExtensionStateChanged=null),null!==this.__configEventsDestroyEvent&&(this.__configEventsDestroyEvent(),this.__configEventsDestroyEvent=null);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".CloseConnection",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};TcHmi.Server.request(request);for(let controlName in this.__destroyEvents){let destroyEvent=this.__destroyEvents[controlName];null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0)}this.__elementLegend[0].removeEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementLegend[0].removeEventListener("touchstart",this.__onCheckboxTouchStart),null===(_b=this.__destroyLocalizationWatch)||void 0===_b||_b.call(this)}__addOrUpdateLocalizedElement(element,key,value=null){if(this.__localizedElements.set(key,{element:element,value:value}),this.__localizationReader){let localizedText=this.__localizationReader.get(key);if(-1!==key.indexOf("Tooltip"))element.title=tchmi_decode_control_characters(localizedText);else if(null!==value)if(-1!==value.indexOf("Label_Text_Date_Placeholder")){let valueLocalization=this.__localizationReader.get("Label_Text_Date_Placeholder");element.textContent=tchmi_decode_control_characters(localizedText+": "+valueLocalization)}else element.textContent=tchmi_decode_control_characters(localizedText+": "+value);else element.textContent=tchmi_decode_control_characters(localizedText)}}__removeLocalizedElement(key){this.__localizedElements.delete(key)}__loadThemedResources(){let chartBackgroundColor=TcHmi.Theme.Resources.get(this,"ChartBackgroundColor");TcHmi.isSolidColor(chartBackgroundColor.value)&&(this.__themeChartBackgroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(chartBackgroundColor.value));let chartForegroundColor=TcHmi.Theme.Resources.get(this,"ChartForegroundColor");TcHmi.isSolidColor(chartForegroundColor.value)&&(this.__themeChartForegroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(chartForegroundColor.value));let overviewBackgroundColor=TcHmi.Theme.Resources.get(this,"OverviewBackgroundColor");TcHmi.isSolidColor(overviewBackgroundColor.value)&&(this.__themeOverviewBackgroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(overviewBackgroundColor.value));let overviewForegroundColor=TcHmi.Theme.Resources.get(this,"OverviewForegroundColor");TcHmi.isSolidColor(overviewForegroundColor.value)&&(this.__themeOverviewForegroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(overviewForegroundColor.value));let canvasBackgroundColor=TcHmi.Theme.Resources.get(this,"CanvasBackgroundColor");TcHmi.isSolidColor(canvasBackgroundColor.value)&&(this.__themeCanvasBackgroundColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(canvasBackgroundColor.value));let axisColor=TcHmi.Theme.Resources.get(this,"AxisColor");TcHmi.isSolidColor(axisColor.value)&&(this.__themeAxisColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(axisColor.value));let gridColor=TcHmi.Theme.Resources.get(this,"GridColor");TcHmi.isSolidColor(gridColor.value)&&(this.__themeGridColor=TcHmi.StyleProvider.resolveSolidColorAsCssValue(gridColor.value)),this.__drawLineChart()}__onThemeDataChanged(){let __this=this;return(evt,ctrl)=>{__this.__loadThemedResources(),__this.__rebuild()}}__onUserDataChanged(){let __this=this;return function(event,data){TcHmi.Server.getCurrentUserConfig().session!==__this.__sessionId&&__this.__serverDomain&&__this.__clearInit()}}__onExtensionStateChanged(){let __this=this;return result=>{if(result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return null!==result.response.commands&&void 0!==result.response.commands&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"]  Server responds with error. Details: "+TcHmi.Log.buildMessage(result.response.error)),void(__this.__loadingSpinner&&__this.__loadingSpinner.remove());if(null!==result.response.commands&&void 0!==result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error&&130!==result.response.commands[i].error.code)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`),void(__this.__loadingSpinner&&__this.__loadingSpinner.remove());if(result.response.commands[i].symbol==="ListDomains::"+__this.__serverDomain+"::state"){let state=result.response.commands[i].readValue;switch(state){case"NotLoaded":case"Loaded":case"Invalid":case"Disabled":case"Unloading":case"NotRunning":null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar),this.__subscriptionIdMenubar=null),null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId),this.__subscriptionId=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow),this.__subscriptionIdActualWindow=null),this.__clearFullControl(),TCHMI_CONSOLE_LOG_LEVEL>=1&&(this.__loadingSpinner&&this.__loadingSpinner.remove(),TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${this.getId()}] Domain: ${this.__serverDomain} is not known. Status: ${state}. Please make sure the server extension is loaded and the domain name is correct.`));break;case"Initialized":this.__isInitialized&&null===this.__openConnectionRequestId&&this.__clearInit()}}}}else __this.__loadingSpinner&&__this.__loadingSpinner.remove(),result.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Framework error= "+result.error+", name="+TcHmi.Errors[result.error]+" while fetching data from server.")}}__scopeEventCallback(){let __this=this;return function(data){if(data.error)TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Server responds with error "+data.error+". Details: "+data.details);else{let payloadResult=data.event;if(!payloadResult||!payloadResult.payload)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error ${data.error}. Details: Event is possibly null.`));{let payload=payloadResult.payload;payload.severity===TcHmi.Server.Events.Severity.Info&&TCHMI_CONSOLE_LOG_LEVEL>=3?TcHmi.Log.infoEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] ScopeExtension has thrown an information. Details: ${payload.message}`):payload.severity===TcHmi.Server.Events.Severity.Warning&&TCHMI_CONSOLE_LOG_LEVEL>=2?TcHmi.Log.warnEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] ScopeExtension has thrown a warning. Details: ${payload.message}`):payload.severity===TcHmi.Server.Events.Severity.Error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] ScopeExtension has thrown an error. Details: ${payload.message}`)}}}}__configEventCallback(){let __this=this;return function(data){if(data.error)TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error ${data.error}. Details: ' + ${data.details}`);else{let payloadResult=data.event;if(!payloadResult||!payloadResult.payload)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error ${data.error}. Details: Event is possibly null.`));{let payload=payloadResult.payload;if(payload.severity===TcHmi.Server.Events.Severity.Info)switch(null!==payload.oldConfigName?TCHMI_CONSOLE_LOG_LEVEL>=3&&TcHmi.Log.infoEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] ScopeExtension has thrown an information. Details: ${payload.configType} from ${payload.oldConfigName} to ${payload.configName}`):TCHMI_CONSOLE_LOG_LEVEL>=3&&TcHmi.Log.infoEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] ScopeExtension has thrown an information. Details: ${payload.configType} ${payload.configName}`),payload.configType){case TcHmiScopeControl.ConfigType.Add:case TcHmiScopeControl.ConfigType.Rename:__this.__scopeConfig&&payload.configName===__this.__scopeConfig.name&&__this.__openConnection();break;case TcHmiScopeControl.ConfigType.Delete:__this.__scopeConfig&&payload.configName===__this.__scopeConfig.name&&__this.__clearFullControl()}}}}}__rebuild(){let __this=this;return(evt,ctrl)=>{if(this.__isAttached)if(__this.__subscriptionIdMenubar)if(__this.__menubar){let enableButtons=TcHmiScopeControl.ButtonsEnabled.None;__this.__menubar.visibleToolstrip&&(enableButtons=__this.__menubar.enabledButtons);let enableTimes=TcHmiScopeControl.TimesEnabled.None;__this.__menubar.visibleTimestrip&&(enableTimes=__this.__menubar.enabledTimeLabels),__this.__createMenuButtons(enableButtons,enableTimes),__this.__calcMenuButtons(),__this.__menubar.visibleToolstrip?0===__this.__menubar.enabledButtons?TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"),__this.__menubar.visibleTimestrip?0===__this.__menubar.enabledTimeLabels?TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none");let menubarHeight=__this.__elementMenuBar.outerHeight(!0),menubarHeightAsNumber=void 0===menubarHeight?0:menubarHeight,legendHeight=__this.__elementLegend.outerHeight(!0),legendHeightAsNumber=void 0===legendHeight?0:legendHeight;__this.__elementChartings.css({height:"calc(100% - "+(menubarHeightAsNumber+10+legendHeightAsNumber)+"px)"}),__this.setChartSize(!0)}else __this.__createMenuButtons(TcHmiScopeControl.ButtonsEnabled.None,TcHmiScopeControl.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none");else __this.__createMenuButtons(TcHmiScopeControl.ButtonsEnabled.None,TcHmiScopeControl.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none");else __this.__drawLineChart()}}__scopeStringToIso(scopeString){if("0,00:00:00,000:000"===scopeString)return"PT0S";let commaResult=scopeString.split(","),colonResult=commaResult[1].split(":"),colonSecondsResult=commaResult[2].split(":"),fullDays=parseInt(commaResult[0],10),years=Math.floor(fullDays/365.25),months=Math.floor(fullDays%365.25/30.4375),days=Math.floor(fullDays%365.25%30.4375),hours=parseInt(colonResult[0],10),minutes=parseInt(colonResult[1],10),seconds=parseInt(colonResult[2],10),f=parseInt(colonSecondsResult[0]+colonSecondsResult[1],10),isoString="";return isoString+="P",years>0&&(isoString+=years+"Y"),months>0&&(isoString+=months+"M"),days>0&&(isoString+=days+"D"),(hours>0||minutes>0||seconds>0||f>0)&&(isoString+="T"),hours>0&&(isoString+=hours+"H"),minutes>0&&(isoString+=minutes+"M"),(seconds>0||0===days&&0===hours&&0===minutes)&&(isoString+=seconds),f>0&&(isoString+="."+("000000"+f).slice(-6).replace(/\.?0+$/,"")),(f>0||seconds>0)&&(isoString+="S"),isoString}__isoToScopeString(t){let seconds=0,minutes=0,hours=0,days=0,months=0,years=0,isTime=!1,current=t.split("");for(let i=0,ii=current.length;i<ii;i++){let num=0,sNum="";for(;current[i]>="0"&&current[i]<="9"||"."===current[i];)sNum+=current[i],i++,num=parseFloat(sNum);switch(current[i]){case"Y":years=num,days+=365.25*years;break;case"D":days=num;break;case"T":isTime=!0;break;case"H":hours=num;break;case"M":isTime?minutes=num:(months=num,days+=30.4375*months);break;case"S":seconds=num}}let milliseconds=seconds.toString().split(".")[1];if(milliseconds){if(milliseconds=milliseconds.slice(0,6),milliseconds.length<6)for(let i=milliseconds.length,ii=6;i<ii;i++)milliseconds+=0}else milliseconds="000000";return days+","+("00"+hours).slice(-2)+":"+("00"+minutes).slice(-2)+":"+("00"+Math.floor(seconds)).slice(-2)+","+("000"+milliseconds.slice(0,3)).slice(-3)+":"+("000"+milliseconds.slice(3,6)).slice(-3)}__isoToMilliSec(t){let seconds=0,minutes=0,hours=0,days=0,months=0,years=0,isneg=!1,isTime=!1,current=t.split("");for(let i=0,ii=current.length;i<ii;i++){let num=0,sNum="";for(;current[i]>="0"&&current[i]<="9"||"."===current[i];)sNum+=current[i],i++,num=parseFloat(sNum);switch(current[i]){case"-":isneg=!0;break;case"Y":years=num;break;case"D":days=num;break;case"T":isTime=!0;break;case"H":hours=num;break;case"M":isTime?minutes=num:months=num;break;case"S":seconds=num}}let milliSec=3154e7*years;return milliSec+=2628e6*months,milliSec+=864e5*days,milliSec+=36e5*hours,milliSec+=6e4*minutes,milliSec+=1e3*seconds,isneg&&(milliSec*=-1),milliSec}__openWebsocket(){TCHMI_ENABLE_DESIGNER_MODE_MASTER||null===this.__openConnectionRequestId&&(this.__isInitialized?this.__openConnection():null===this.__initEventDestroyEvent&&(this.__initEventDestroyEvent=TcHmi.EventProvider.register(this.__id+".onInitChanged",this.__initChanged())))}__openConnection(){if(!TCHMI_ENABLE_DESIGNER_MODE_MASTER&&null===this.__openConnectionRequestId){null!==this.__subscriptionIdMenubar&&(TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar),this.__subscriptionIdMenubar=null),null!==this.__subscriptionId&&(TcHmi.Server.unsubscribe(this.__subscriptionId),this.__subscriptionId=null),null!==this.__subscriptionIdActualWindow&&(TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow),this.__subscriptionIdActualWindow=null);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".OpenConnection",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),TcHmi.Server.releaseRequest(this.__openConnectionRequestId),this.__openConnectionRequestId=TcHmi.Server.requestEx(request,null,this.__connectionCallback())}}__clearFullControl(){this.__createMenuButtons(TcHmiScopeControl.ButtonsEnabled.None,TcHmiScopeControl.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTimeBar,"display","none"),this.__createLegend(void 0);const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};for(let i=0,ii=this.__lineCharts.length;i<ii;i++){let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),canvas.removeEventListener("wheel",this.__mousewheelHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions)),this.__lineCharts[i].remove(),this.__chartingElements[i].remove()}if(this.__lineCharts=[],this.__chartingElements=[],this.__overviewChart){let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("mousemove",this.__mousemoveOverviewHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions)),this.__overviewChart.remove(),this.__overviewChart=null}this.__elementOverview.css({display:"none"}),this.__elementChartName.css("display","none"),this.__elementChartings.css({height:"100%","background-color":"","background-image":""}),this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart").remove();let canvasBorderElem=this.__elementBorder[0],contextBorderElem=canvasBorderElem.getContext("2d");contextBorderElem&&contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height),this.__resizeLines=[]}__connectionCallback(){let __this=this;return function(result){if(!__this.__isDestroyed&&null!==__this.__openConnectionRequestId)if(__this.__openConnectionRequestId=null,result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return null!==result.response.commands&&void 0!==result.response.commands&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Server responds with error. Details: "+TcHmi.Log.buildMessage(result.response.error)),void(__this.__loadingSpinner&&__this.__loadingSpinner.remove());if(null!==result.response.commands&&void 0!==result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error&&130!==result.response.commands[i].error.code)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`),__this.__loadingSpinner&&__this.__loadingSpinner.remove(),void __this.__clearFullControl();result.response.commands[i].symbol===__this.__serverDomain+".OpenConnection"&&__this.__unsubscribeMenubar()}}else __this.__loadingSpinner&&__this.__loadingSpinner.remove(),result.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Framework error= "+result.error+", name="+TcHmi.Errors[result.error]+" while fetching data from server.")}}__setChartSizeCallback(){let __this=this;return function(result){if(!__this.__isDestroyed&&null!==__this.__setChartSizeRequestId)if(__this.__setChartSizeRequestId=null,result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return null!==result.response.commands&&void 0!==result.response.commands&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Server responds with error. Details: "+TcHmi.Log.buildMessage(result.response.error)),void(__this.__loadingSpinner&&__this.__loadingSpinner.remove());if(null!==result.response.commands&&void 0!==result.response.commands)for(let i=0,ii=result.response.commands.length;i<ii;i++)result.response.commands[i].error&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`),__this.__loadingSpinner&&__this.__loadingSpinner.remove()),result.response.commands[i].symbol===__this.__serverDomain+".SetChartSize"&&(__this.__loadingSpinner&&__this.__loadingSpinner.remove(),__this.__unsubscribe())}else __this.__loadingSpinner&&__this.__loadingSpinner.remove(),result.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Framework error= "+result.error+", name="+TcHmi.Errors[result.error]+" while fetching data from server.")}}__unsubscribeMenubar(){null!==this.__subscriptionIdMenubar?TcHmi.Server.unsubscribe(this.__subscriptionIdMenubar,this.__unsubscribeMenubarCallback()):this.__subscribeMenubar()}__unsubscribeMenubarCallback(){let __this=this;return function(result){__this.__subscriptionIdMenubar=null,__this.__subscribeMenubar()}}__subscribeMenubar(){if(this.__subscriptionIdMenubar=null,this.__isAttached&&this.__scopeConfig){let writeValue,symbolMenubar=this.__serverDomain+".GetMenubar",symbolLegend=this.__serverDomain+".GetLegend";writeValue={controlName:this.__id,scopeConfig:this.__scopeConfig},this.__showLegend?this.__subscriptionIdMenubar=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolMenubar,writeValue:writeValue},{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolLegend,writeValue:writeValue}],300,this.__getMenubarCallback()):this.__subscriptionIdMenubar=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolMenubar,writeValue:writeValue}],300,this.__getMenubarCallback())}}__getMenubarCallback(){let __this=this;return function(result){if(!__this.__isDestroyed)if(result&&result.error===TcHmi.Errors.NONE&&result.response&&result.response.id===__this.__subscriptionIdMenubar){if(result.response.error)return null!==result.response.commands&&void 0!==result.response.commands&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Server responds with error. Details: "+TcHmi.Log.buildMessage(result.response.error)),__this.__loadingSpinner&&__this.__loadingSpinner.remove(),__this.__createMenuButtons(TcHmiScopeControl.ButtonsEnabled.None,TcHmiScopeControl.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none"),void __this.__createLegend(void 0);if(null!==result.response.commands&&void 0!==result.response.commands&&void 0!==__this.__subscriptionIdMenubar){for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error)return 130!==result.response.commands[i].error.code&&(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`),__this.__loadingSpinner&&__this.__loadingSpinner.remove()),__this.__createMenuButtons(TcHmiScopeControl.ButtonsEnabled.None,TcHmiScopeControl.TimesEnabled.None),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"),TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none"),void __this.__createLegend(void 0);if(result.response.commands[i].readValue)if(result.response.commands[i].symbol===__this.__serverDomain+".GetMenubar"){if(__this.__menubar=result.response.commands[i].readValue,__this.__menubar){let enableButtons=TcHmiScopeControl.ButtonsEnabled.None;__this.__menubar.visibleToolstrip&&(enableButtons=__this.__menubar.enabledButtons);let enableTimes=TcHmiScopeControl.TimesEnabled.None;__this.__menubar.visibleTimestrip&&(enableTimes=__this.__menubar.enabledTimeLabels),__this.__createMenuButtons(enableButtons,enableTimes),__this.__calcMenuButtons(),__this.__menubar.visibleToolstrip?0===__this.__menubar.enabledButtons?TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementToolBar,"display","none"),__this.__menubar.visibleTimestrip?0===__this.__menubar.enabledTimeLabels?TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","flex"):TcHmi.StyleProvider.setSimpleElementStyle(__this.__elementTimeBar,"display","none")}}else result.response.commands[i].symbol===__this.__serverDomain+".GetLegend"&&(__this.__legend=result.response.commands[i].readValue,__this.__createLegend(__this.__legend))}let menubarHeight=__this.__elementMenuBar.outerHeight(!0),menubarHeightAsNumber=void 0===menubarHeight?0:menubarHeight,legendHeight=__this.__elementLegend.outerHeight(!0),legendHeightAsNumber=void 0===legendHeight?0:legendHeight;__this.__elementChartings.css({height:"calc(100% - "+(menubarHeightAsNumber+10+legendHeightAsNumber)+"px)"}),__this.setChartSize(!1)}}else __this.__loadingSpinner&&__this.__loadingSpinner.remove(),result.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Framework error= "+result.error+", name="+TcHmi.Errors[result.error]+" while fetching data from server.")}}__unsubscribe(changedServerInterval=!1){null!==this.__subscriptionId?TcHmi.Server.unsubscribe(this.__subscriptionId,this.__unsubscribeGetDataCallback()):this.__subscribeGetData(),changedServerInterval||(null!==this.__subscriptionIdActualWindow?TcHmi.Server.unsubscribe(this.__subscriptionIdActualWindow,this.__unsubscribeActualWindowCallback()):this.__subscribeActualWindow())}__unsubscribeGetDataCallback(){let __this=this;return function(result){__this.__subscriptionId=null,__this.__subscribeGetData()}}__subscribeGetData(){if(this.__isAttached&&this.__scopeConfig&&this.__serverInterval){let writeValueData,symbolData=this.__serverDomain+".GetData",symbolWindow=this.__serverDomain+".GetWindow",symbolLayout=this.__serverDomain+".GetLayout";writeValueData={controlName:this.__id,scopeConfig:this.__scopeConfig},TcHmi.Server.releaseRequest(this.__subscriptionId),this.__subscriptionId=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolLayout,writeValue:writeValueData},{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolData,writeValue:writeValueData},{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbolWindow,writeValue:writeValueData}],this.__serverInterval,this.__getDataCallback())}}__unsubscribeActualWindowCallback(){let __this=this;return function(result){__this.__subscriptionIdActualWindow=null,__this.__subscribeActualWindow()}}__subscribeActualWindow(){if(this.__isAttached&&this.__scopeConfig){let writeValueData;writeValueData={controlName:this.__id,scopeConfig:this.__scopeConfig},this.__subscriptionIdActualWindow=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:this.__serverDomain+".GetActualWindow",writeValue:writeValueData}],300,this.__getDataCallback())}}__getDataCallback(){let __this=this;return function(result){if(!__this.__isDestroyed)if(__this.__loadingSpinner&&__this.__loadingSpinner.remove(),result&&result.error===TcHmi.Errors.NONE&&result.response){if(result.response.error)return void(null!==result.response.commands&&void 0!==result.response.commands&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Server responds with error. Details: "+TcHmi.Log.buildMessage(result.response.error)));if(result.response.commands&&void 0!==__this.__subscriptionId)for(let i=0,ii=result.response.commands.length;i<ii;i++){if(result.response.commands[i].error){if(31===result.response.commands[i].error.code)return void __this.__openWebsocket();130!==result.response.commands[i].error.code&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")}, Id=${__this.getId()}] Server responds with error for command for symbol=${result.response.commands[i].symbol}. Details: ${TcHmi.Log.buildMessage(result.response.commands[i].error)}`)}if(result.response.commands[i].symbol===__this.__serverDomain+".GetLayout"&&result.response.id===__this.__subscriptionId){let chartType=null;__this.__scopeLayout&&(chartType=__this.__scopeLayout.chartType);let drawOnlyOverview=!1,newLayout=result.response.commands[i].readValue;if(newLayout&&__this.__scopeLayout&&newLayout.charts&&__this.__scopeLayout.charts&&JSON.stringify(newLayout.charts)===JSON.stringify(__this.__scopeLayout.charts)&&(drawOnlyOverview=!0),__this.__scopeLayout&&__this.__scopeLayout.chartType!==chartType&&(__this.__mouseMode=null),drawOnlyOverview&&__this.__manipulationInfo.isManipulating&&-1===__this.__manipulationInfo.elementIndex&&__this.__overviewChart&&__this.__scopeLayout&&__this.__scopeLayout.overview&&__this.__scopeGraphWindow&&__this.__scopeGraphWindow.overviewRect){let context=__this.__overviewChart.getCanvasZooming().getContext("2d");if(null===context)return;let width=__this.__manipulationInfo.end.x-__this.__manipulationInfo.start.x;if(__this.__manipulationInfo.isOverviewSizeChanged)if(__this.__manipulationInfo.beginOverviewRectChanging){let newWidth=__this.__scopeGraphWindow.overviewRect.dimensions.width-width;newWidth<5&&(newWidth=5),context.clearRect(0,0,context.canvas.width,context.canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(__this.__scopeLayout.overview.canvas.position.x+__this.__scopeGraphWindow.overviewRect.position.x+width,__this.__scopeLayout.overview.canvas.position.y,newWidth,__this.__scopeGraphWindow.overviewRect.dimensions.height)}else{let newWidth=__this.__scopeGraphWindow.overviewRect.dimensions.width+width;newWidth<5&&(newWidth=5),context.clearRect(0,0,context.canvas.width,context.canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(__this.__scopeLayout.overview.canvas.position.x+__this.__scopeGraphWindow.overviewRect.position.x,__this.__scopeLayout.overview.canvas.position.y,newWidth,__this.__scopeGraphWindow.overviewRect.dimensions.height)}else context.clearRect(0,0,context.canvas.width,context.canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(__this.__scopeLayout.overview.canvas.position.x+__this.__scopeGraphWindow.overviewRect.position.x+width,__this.__scopeLayout.overview.canvas.position.y,__this.__scopeGraphWindow.overviewRect.dimensions.width,__this.__scopeGraphWindow.overviewRect.dimensions.height)}else __this.__scopeLayout=result.response.commands[i].readValue,__this.__drawLineChart(drawOnlyOverview);__this.__scopeGraphWindow&&__this.__scopeLayout?__this.__enableOrDisableMenuControls(__this.__scopeGraphWindow.scopeState,__this.__scopeGraphWindow.liveState,__this.__scopeGraphWindow.undo,__this.__scopeGraphWindow.redo,TcHmiScopeControl.ChartType[__this.__scopeLayout.chartType]):__this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl.ChartType.YT)}else if(result.response.commands[i].symbol===__this.__serverDomain+".GetWindow"&&result.response.id===__this.__subscriptionId){if(__this.__manipulationInfo.isManipulating&&-1===__this.__manipulationInfo.elementIndex)return;if(__this.__scopeGraphWindow=result.response.commands[i].readValue,__this.__updatedMenuValues(__this.__scopeGraphWindow),__this.__scopeGraphWindow&&__this.__scopeLayout?__this.__enableOrDisableMenuControls(__this.__scopeGraphWindow.scopeState,__this.__scopeGraphWindow.liveState,__this.__scopeGraphWindow.undo,__this.__scopeGraphWindow.redo,TcHmiScopeControl.ChartType[__this.__scopeLayout.chartType]):__this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl.ChartType.YT),__this.__scopeGraphWindow&&__this.__scopeGraphWindow.overviewRect&&__this.__scopeLayout&&__this.__scopeLayout.overview&&__this.__overviewChart){if(__this.__manipulationInfo.isManipulating&&-1===__this.__manipulationInfo.elementIndex)break;let canvas=__this.__overviewChart.getCanvasZooming(),context=canvas.getContext("2d");if(context){__this.__scopeLayout.overview.canvas;context.clearRect(0,0,canvas.width,canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(__this.__scopeLayout.overview.canvas.position.x+__this.__scopeGraphWindow.overviewRect.position.x,__this.__scopeLayout.overview.canvas.position.y,__this.__scopeGraphWindow.overviewRect.dimensions.width,__this.__scopeGraphWindow.overviewRect.dimensions.height)}if(__this.__scopeLayout&&__this.__scopeLayout.overview){let offsetTop=__this.__scopeLayout.overview.canvas.position.y,offsetLeft=__this.__scopeLayout.overview.canvas.position.x;__this.__overviewRectangle={position:{x:offsetLeft+__this.__scopeGraphWindow.overviewRect.position.x,y:offsetTop},dimensions:{width:__this.__scopeGraphWindow.overviewRect.dimensions.width,height:__this.__scopeGraphWindow.overviewRect.dimensions.height}}}}}else if(result.response.commands[i].symbol===__this.__serverDomain+".GetData"&&result.response.id===__this.__subscriptionId){if(__this.__manipulationInfo.isManipulating&&-1===__this.__manipulationInfo.elementIndex)return;if(null===__this.__startRecordRequestId&&null===__this.__startRequestId&&null===__this.__stopRecordRequestId&&null===__this.__stopRequestId&&null===__this.__zoomRequestId&&null===__this.__panRequestId&&null===__this.__wheelRequestId&&null===__this.__zoomOutRequestId&&null===__this.__unzoomRequestId&&null===__this.__displayWidthRequestId&&null===__this.__gotoRequestId&&null===__this.__scrollRequestId&&null===__this.__scrollBigRequestId&&null===__this.__undoRequestId&&null===__this.__redoRequestId&&null===__this.__setOverviewModeRequestId&&null===__this.__setOverviewRectRequestId&&null===__this.__getTooltipRequestId&&null===__this.__resizeChartsRequestId&&null===__this.__changeChannelStateRequestId&&(__this.__scopeGraphData=result.response.commands[i].readValue,__this.__scopeGraphData&&__this.__lineCharts&&__this.__lineCharts.length>0&&__this.__scopeLayout&&__this.__lineCharts.length===__this.__scopeLayout.charts.length)){if(__this.__scopeLayout.overview){let overviewData=__this.__scopeGraphData.overview;if(overviewData&&__this.__overviewChart&&overviewData.graphs)for(let graphKey in overviewData.graphs){let graph=overviewData.graphs[graphKey];if(graph&&__this.__overviewChart){let overviewGraph=__this.__overviewChart.getLineGraphWithName(graphKey);overviewGraph&&overviewGraph.setPoints(graph.axesData)}}}for(let i=0,ii=__this.__scopeGraphData.charts.length;i<ii;i++){let chartData=__this.__scopeGraphData.charts[i],chart=__this.__lineCharts[i];if(chart&&chartData&&chartData.graphs)for(let chartGraphKey in chartData.graphs){let graph=chartData.graphs[chartGraphKey];if(graph){let lineGraph=chart.getLineGraphWithName(chartGraphKey);lineGraph&&(lineGraph.setPoints(graph.axesData),lineGraph.setZeroPoint(graph.zeroPoint),lineGraph.setLineSeries(graph.lineSeries))}}}for(let i=0,ii=__this.__lineCharts.length;i<ii;i++)__this.__lineCharts[i].setLineChanged(!0),__this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?__this.__lineCharts[i].draw(__this.__scopeLayout.charts[i],null):__this.__lineCharts[i].draw(__this.__scopeLayout.charts[i],__this.__themeCanvasBackgroundColor);__this.__overviewChart&&__this.__scopeLayout.overview&&(__this.__overviewChart.setLineChanged(!0),__this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?__this.__overviewChart.draw(__this.__scopeLayout.overview,null):__this.__overviewChart.draw(__this.__scopeLayout.overview,__this.__themeCanvasBackgroundColor))}}else if(result.response.commands[i].symbol===__this.__serverDomain+".StartRecord")__this.__startRecordRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".StartDisplay")__this.__startRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".StopRecord")__this.__stopRecordRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".StopDisplay")__this.__stopRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Zoom")__this.__zoomRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Pan")__this.__panRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Wheel")__this.__wheelRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".ZoomOutMax")__this.__zoomOutRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".ZoomToDefault")__this.__unzoomRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".SetDisplayWidth")__this.__displayWidthRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Goto")__this.__gotoRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Scroll")__this.__scrollRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".ScrollBig")__this.__scrollBigRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Undo")__this.__undoRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".Redo")__this.__redoRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".SetOverviewMode")__this.__setOverviewModeRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".SetOverviewRect")__this.__setOverviewRectRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".GetTooltip"){__this.__getTooltipRequestId=null;let readValue=result.response.commands[i].readValue;readValue.displayText&&readValue.timeoutMS?(__this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0},__this.__showTooltip(readValue),__this.__scopeGraphWindow&&__this.__scopeLayout?__this.__enableOrDisableMenuControls(__this.__scopeGraphWindow.scopeState,__this.__scopeGraphWindow.liveState,__this.__scopeGraphWindow.undo,__this.__scopeGraphWindow.redo,TcHmiScopeControl.ChartType[__this.__scopeLayout.chartType]):__this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl.ChartType.YT)):__this.__userInteractionStart(__this.__manipulationInfo.mousePosition.x,__this.__manipulationInfo.mousePosition.y,result.response.commands[i].writeValue.chartIndex)}else if(result.response.commands[i].symbol===__this.__serverDomain+".ResizeCharts")__this.__resizeChartsRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".ChangeChannelState")__this.__changeChannelStateRequestId=null,__this.__unsubscribe();else if(result.response.commands[i].symbol===__this.__serverDomain+".GetActualWindow"){let actualWindow=result.response.commands[i].readValue;if(__this.__scopeLayout&&actualWindow?__this.__enableOrDisableMenuControls(actualWindow.scopeState,actualWindow.liveState,actualWindow.undo,actualWindow.redo,TcHmiScopeControl.ChartType[__this.__scopeLayout.chartType]):__this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl.ChartType.YT),__this.__scopeGraphWindow){let windowData=__this.__scopeGraphWindow;actualWindow&&(windowData.liveState=actualWindow.liveState,windowData.displayWidth=actualWindow.displayWidth,windowData.redo=actualWindow.redo,windowData.scopeState=actualWindow.scopeState,windowData.undo=actualWindow.undo,windowData.xAxisEnd=actualWindow.xAxisEnd,windowData.xAxisStart=actualWindow.xAxisStart),__this.__updatedMenuValues(windowData)}else __this.__updatedMenuValues(null)}}}else result.error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+__this.__type+(__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN)!==__this.__type?", Origin="+__classPrivateFieldGet(TcHmiScopeControl,_a,"f",_TcHmiScopeControl_tchmiFQN):"")+", Id="+__this.getId()+"] Framework error= "+result.error+", name="+TcHmi.Errors[result.error]+" while fetching data from server.")}}__drawLineChart(drawOnlyOverview=!1){let canvasBorderElem=this.__elementBorder[0];const passiveEventOptions={passive:!0,capture:!1},activeEventOptions={passive:!1,capture:!1};if(this.__scopeLayout&&this.__scopeLayout.charts){if(!drawOnlyOverview){if(this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0},null===this.__mouseMode)switch(TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]){case TcHmiScopeControl.ChartType.SingleBarChart:this.setMouseMode(TcHmiScopeControl.MouseMode.PanY);break;case TcHmiScopeControl.ChartType.YT:case TcHmiScopeControl.ChartType.XY:case TcHmiScopeControl.ChartType.ArrayBarChart:default:this.setMouseMode(TcHmiScopeControl.MouseMode.PanXY)}let chartLength=this.__scopeLayout.charts.length;if(chartLength>this.__lineCharts.length)for(let i=this.__lineCharts.length,ii=chartLength;i<ii;i++){let newChart=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart"></div>');this.__elementBorder.before(newChart),this.__chartingElements.push(newChart),this.__lineCharts.push(new Beckhoff.TcHmiScopeControl.Charting.ScopeChart(newChart,this.__scopeLayout.charts[i].dimensions.width,this.__scopeLayout.charts[i].dimensions.height));let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.addEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.addEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),canvas.addEventListener("wheel",this.__mousewheelHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions))}else if(chartLength<this.__lineCharts.length)for(let i=this.__lineCharts.length-1,ii=chartLength-1;i>=ii;i--)if(i>=chartLength){let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),canvas.removeEventListener("wheel",this.__mousewheelHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions)),this.__lineCharts[i].remove(),this.__lineCharts.splice(i,1),this.__chartingElements[i].remove(),this.__chartingElements.splice(i,1)}this.__resizeLines=[];let heightObjectsBeforeCharts=0;this.__scopeLayout.overview&&(heightObjectsBeforeCharts+=this.__scopeLayout.overview.dimensions.height+5);let width=this.__elementChartings.innerWidth(),height=this.__elementChartings.innerHeight();this.__elementBorder.attr("width",width).attr("height",height);let contextBorderElem=canvasBorderElem.getContext("2d");contextBorderElem&&(contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height),this.__themeChartForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.Theme?contextBorderElem.strokeStyle=this.__themeChartForegroundColor:contextBorderElem.strokeStyle=this.__scopeLayout.foregroundColor,contextBorderElem.lineWidth=1,contextBorderElem.beginPath());let headlineHeight=0;this.__scopeLayout.headline?(this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__elementChartName.css({display:"block","font-size":this.__scopeLayout.headline.fontSize+"pt",color:this.__scopeLayout.headline.color,width:this.__scopeLayout.headline.dimensions.width,height:this.__scopeLayout.headline.dimensions.height,top:heightObjectsBeforeCharts+"px","border-bottom":"1px solid "+this.__scopeLayout.foregroundColor}):this.__elementChartName.css({display:"block","font-size":this.__scopeLayout.headline.fontSize+"pt",color:null!==this.__themeChartForegroundColor?this.__themeChartForegroundColor:this.__scopeLayout.headline.color,width:this.__scopeLayout.headline.dimensions.width,height:this.__scopeLayout.headline.dimensions.height,top:heightObjectsBeforeCharts+"px","border-bottom":"1px solid "+this.__themeChartForegroundColor}),this.__elementChartName[0].textContent=this.__scopeLayout.headline.label,headlineHeight=this.__scopeLayout.headline.dimensions.height):this.__elementChartName.css("display","none"),this.__themeChartBackgroundColor&&this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.Theme?this.__elementChartings.css({"background-color":this.__themeChartBackgroundColor,"background-image":""}):this.__scopeLayout.gradientBackground?this.__elementChartings.css({"background-image":"linear-gradient("+this.__scopeLayout.backgroundColor+", "+this.__scopeLayout.gradientBackgroundColor+")","background-color":""}):this.__elementChartings.css({"background-color":this.__scopeLayout.backgroundColor,"background-image":""});let beginHorizontalLineY=0;this.__scopeLayout.headline&&(beginHorizontalLineY=this.__scopeLayout.headline.dimensions.height);for(let i=0,ii=this.__scopeLayout.charts.length;i<ii;i++)if(this.__scopeLayout.charts[i].visible){if(contextBorderElem){let startPointHorizontal={x:0,y:(heightObjectsBeforeCharts+this.__scopeLayout.charts[i].position.y|0)-.5},endPointHorizontal={x:0|canvasBorderElem.width,y:(heightObjectsBeforeCharts+this.__scopeLayout.charts[i].position.y|0)-.5},lineWasDrawHorizontal=this.__resizeLines.some(elem=>elem.startPoint.y===startPointHorizontal.y);this.__scopeLayout.charts[i].position.y===beginHorizontalLineY||lineWasDrawHorizontal||(contextBorderElem.moveTo(startPointHorizontal.x,startPointHorizontal.y),contextBorderElem.lineTo(endPointHorizontal.x,endPointHorizontal.y),this.__resizeLines.push({orientation:TcHmiScopeControl.Orientation.Horizontal,startPoint:startPointHorizontal,endPoint:endPointHorizontal,chartIndex:i}));let startPointVertical={x:(this.__scopeLayout.charts[i].position.x+this.__scopeLayout.charts[i].dimensions.width|0)-.5,y:heightObjectsBeforeCharts+headlineHeight|0},endPointVertical={x:(this.__scopeLayout.charts[i].position.x+this.__scopeLayout.charts[i].dimensions.width|0)-.5,y:0|canvasBorderElem.height},lineWasDrawVertical=this.__resizeLines.some(elem=>elem.startPoint.x===startPointVertical.x);TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]!==TcHmiScopeControl.ChartType.SingleBarChart||lineWasDrawVertical||(contextBorderElem.moveTo(startPointVertical.x,startPointVertical.y),contextBorderElem.lineTo(endPointVertical.x,endPointVertical.y),this.__resizeLines.push({orientation:TcHmiScopeControl.Orientation.Vertical,startPoint:startPointVertical,endPoint:endPointVertical,chartIndex:i}))}this.__lineCharts[i].clear(this.__scopeLayout.charts[i].dimensions.width,this.__scopeLayout.charts[i].dimensions.height),this.__chartingElements[i].css({width:this.__scopeLayout.charts[i].dimensions.width+"px",height:this.__scopeLayout.charts[i].dimensions.height+"px",left:this.__scopeLayout.charts[i].position.x,top:heightObjectsBeforeCharts+this.__scopeLayout.charts[i].position.y});let chart=this.__scopeLayout.charts[i];for(let j=0,jj=chart.verticalAxis.length;j<jj;j++)chart.verticalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].addYAxis(chart.verticalAxis[j],null,null):this.__lineCharts[i].addYAxis(chart.verticalAxis[j],this.__themeAxisColor,this.__themeAxisColor)),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].addGrid(null,chart.verticalAxis[j],chart.gridSize,null):this.__lineCharts[i].addGrid(null,chart.verticalAxis[j],chart.gridSize,this.__themeGridColor),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].addSubgrid(null,chart.verticalAxis[j],chart.gridSize,null):this.__lineCharts[i].addSubgrid(null,chart.verticalAxis[j],chart.gridSize,this.__themeGridColor);for(let j=0,jj=chart.horizontalAxis.length;j<jj;j++)chart.horizontalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].addXAxis(chart.horizontalAxis[j],null,null):this.__lineCharts[i].addXAxis(chart.horizontalAxis[j],this.__themeAxisColor,this.__themeAxisColor)),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].addGrid(chart.horizontalAxis[j],null,chart.gridSize,null):this.__lineCharts[i].addGrid(chart.horizontalAxis[j],null,chart.gridSize,this.__themeGridColor),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].addSubgrid(chart.horizontalAxis[j],null,chart.gridSize,null):this.__lineCharts[i].addSubgrid(chart.horizontalAxis[j],null,chart.gridSize,this.__themeGridColor);if(this.__scopeLayout.charts[i].graphs)for(let j=0,jj=this.__scopeLayout.charts[i].graphs.length;j<jj;j++)this.__lineCharts[i].addLineGraph(this.__scopeLayout.charts[i].graphs[j],{dimensions:chart.gridSize.dimensions,position:chart.gridSize.position});if(this.__scopeGraphData&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key],chart=this.__lineCharts[i];if(graph&&chart){let lineGraph=chart.getLineGraphWithName(key);lineGraph&&(lineGraph.setPoints(graph.axesData),lineGraph.setZeroPoint(graph.zeroPoint),lineGraph.setLineSeries(graph.lineSeries))}}this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__lineCharts[i].draw(this.__scopeLayout.charts[i],null):this.__lineCharts[i].draw(this.__scopeLayout.charts[i],this.__themeCanvasBackgroundColor)}else this.__lineCharts[i].clear(0,0),this.__chartingElements[i].css({width:"0px",height:"0px",left:"0px",top:"0px"});contextBorderElem&&contextBorderElem.stroke()}if(this.__scopeLayout.overview){if(this.__resizeLines.push({orientation:TcHmiScopeControl.Orientation.Horizontal,startPoint:{x:0,y:1+(0|this.__scopeLayout.overview.dimensions.height)},endPoint:{x:0|canvasBorderElem.width,y:1+(0|this.__scopeLayout.overview.dimensions.height)},chartIndex:-1}),this.__showOverview=!0,this.__overviewChart)this.__overviewChart.clear(this.__scopeLayout.overview.dimensions.width,this.__scopeLayout.overview.dimensions.height);else{this.__overviewChart=new Beckhoff.TcHmiScopeControl.Charting.ScopeChart(this.__elementOverview,this.__scopeLayout.overview.dimensions.width,this.__scopeLayout.overview.dimensions.height);let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.addEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.addEventListener("mousemove",this.__mousemoveOverviewHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.addEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions))}this.__elementOverview.css({display:"block",width:this.__scopeLayout.overview.dimensions.width+"px",height:this.__scopeLayout.overview.dimensions.height+"px"});for(let j=0,jj=this.__scopeLayout.overview.verticalAxis.length;j<jj;j++)this.__scopeLayout.overview.verticalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.addYAxis(this.__scopeLayout.overview.verticalAxis[j],null,null):this.__overviewChart.addYAxis(this.__scopeLayout.overview.verticalAxis[j],this.__themeOverviewForegroundColor,this.__themeOverviewForegroundColor)),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.addGrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addGrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.addSubgrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addSubgrid(null,this.__scopeLayout.overview.verticalAxis[j],this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor);for(let j=0,jj=this.__scopeLayout.overview.horizontalAxis.length;j<jj;j++)this.__scopeLayout.overview.horizontalAxis[j].visible&&(this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.addXAxis(this.__scopeLayout.overview.horizontalAxis[j],null,null):this.__overviewChart.addXAxis(this.__scopeLayout.overview.horizontalAxis[j],this.__themeOverviewForegroundColor,this.__themeOverviewForegroundColor)),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.addGrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addGrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.addSubgrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,null):this.__overviewChart.addSubgrid(this.__scopeLayout.overview.horizontalAxis[j],null,this.__scopeLayout.overview.gridSize,this.__themeOverviewForegroundColor);if(this.__scopeLayout.overview.graphs)for(let j=0,jj=this.__scopeLayout.overview.graphs.length;j<jj;j++)this.__overviewChart.addLineGraph(this.__scopeLayout.overview.graphs[j],{dimensions:this.__scopeLayout.overview.gridSize.dimensions,position:this.__scopeLayout.overview.gridSize.position});if(this.__scopeGraphData&&this.__overviewChart&&this.__scopeGraphData.overview&&this.__scopeGraphData.overview.graphs)for(let key in this.__scopeGraphData.overview.graphs){let graph=this.__scopeGraphData.overview.graphs[key];if(graph){let overviewGraph=this.__overviewChart.getLineGraphWithName(key);overviewGraph&&overviewGraph.setPoints(graph.axesData)}}if(this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?this.__overviewChart.draw(this.__scopeLayout.overview,null):this.__overviewChart.draw(this.__scopeLayout.overview,this.__themeCanvasBackgroundColor),this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect){let canvas=this.__overviewChart.getCanvasZooming(),context=canvas.getContext("2d");context&&(context.clearRect(0,0,canvas.width,canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x,this.__scopeLayout.overview.canvas.position.y,this.__scopeGraphWindow.overviewRect.dimensions.width,this.__scopeGraphWindow.overviewRect.dimensions.height))}}else if(this.__showOverview=!1,this.__elementOverview.css({display:"none"}),this.__overviewChart){let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("mousemove",this.__mousemoveOverviewHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions)),this.__overviewChart.remove(),this.__overviewChart=null}}else{for(let i=0,ii=this.__lineCharts.length;i<ii;i++){let canvas=this.__lineCharts[i].getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("wheel",this.__mousewheelHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions)),this.__lineCharts[i].remove(),this.__chartingElements[i].remove()}if(this.__lineCharts=[],this.__chartingElements=[],this.__overviewChart){let canvas=this.__overviewChart.getCanvasZooming();canvas&&(canvas.removeEventListener("mousedown",this.__mousedownHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("mousemove",this.__mousemoveOverviewHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&passiveEventOptions),canvas.removeEventListener("touchstart",this.__touchstartHandler,!!TCHMI_EVENT_OPTION_OBJECT_SUPPORTED&&activeEventOptions)),this.__overviewChart.remove(),this.__overviewChart=null}if(this.__elementOverview.css({display:"none"}),this.__elementChartName.css("display","none"),this.__menubar||this.__legend){let menubarHeight=this.__elementMenuBar.outerHeight(!0),menubarHeightAsNumber=void 0===menubarHeight?0:menubarHeight,legendHeight=this.__elementLegend.outerHeight(!0),legendHeightAsNumber=void 0===legendHeight?0:legendHeight;this.__elementChartings.css({height:"calc(100% - "+(menubarHeightAsNumber+10+legendHeightAsNumber)+"px)","background-color":"","background-image":""})}else this.__elementChartings.css({height:"100%","background-color":"","background-image":""});this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart").remove();let contextBorderElem=canvasBorderElem.getContext("2d");contextBorderElem&&contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height)}}__onPressed(){let __this=this;return function(evt){null!==__this.__elementMenuBarDropdown[0].parentElement&&__this.showOptions(),-1!==evt.name.search("options")?__this.showOptions():-1!==evt.name.search("Run")?null!==__this.__subscriptionId&&__this.startDisplay():-1!==evt.name.search("Pause")?null!==__this.__subscriptionId&&__this.stopDisplay():-1!==evt.name.search("Unzoom")?null!==__this.__subscriptionId&&__this.zoomToDefault():-1!==evt.name.search("ZoomOutMax")?null!==__this.__subscriptionId&&__this.zoomOutMax():-1!==evt.name.search("PanXY")?__this.__mouseMode=TcHmiScopeControl.MouseMode.PanXY:-1!==evt.name.search("PanY")?__this.__mouseMode=TcHmiScopeControl.MouseMode.PanY:-1!==evt.name.search("Pan")?__this.__mouseMode=TcHmiScopeControl.MouseMode.PanX:-1!==evt.name.search("ZoomXY")?__this.__mouseMode=TcHmiScopeControl.MouseMode.ZoomXY:-1!==evt.name.search("ZoomY")?__this.__mouseMode=TcHmiScopeControl.MouseMode.ZoomY:-1!==evt.name.search("Zoom")?__this.__mouseMode=TcHmiScopeControl.MouseMode.ZoomX:-1!==evt.name.search("ScrollBackBig")?__this.scrollBig(TcHmiScopeControl.Direction.Reverse):-1!==evt.name.search("ScrollBackSmall")?__this.scroll(TcHmiScopeControl.Direction.Reverse):-1!==evt.name.search("ScrollForwardBig")?__this.scrollBig(TcHmiScopeControl.Direction.Forward):-1!==evt.name.search("ScrollForwardSmall")?__this.scroll(TcHmiScopeControl.Direction.Forward):-1!==evt.name.search("Undo")?__this.undo():-1!==evt.name.search("Redo")?__this.redo():-1!==evt.name.search("Overview")?(__this.__showOverview=!0!==__this.__showOverview,__this.setOverviewMode()):-1!==evt.name.search("StartRecord")?__this.startRecord():-1!==evt.name.search("StopRecord")&&__this.stopRecord()}}__onUserInteractionFinished(){let __this=this;return function(evt){if(-1!==evt.name.search("DisplaywidthTextBox")){if(null!==__this.__subscriptionId){let textboxElem=__this.__toolBarControls.DisplaywidthTextBox;if(textboxElem){let textboxText=textboxElem.getText();textboxText!==__this.__displayWidthText&&(textboxText=void 0===textboxText?"":textboxText,__this.setDisplayWidth(textboxText))}}}else if(-1!==evt.name.search("GotoTextBox")&&null!==__this.__subscriptionId){let textboxElem=__this.__toolBarControls.GotoTextBox;if(textboxElem){let textboxText=textboxElem.getText();textboxText!==__this.__gotoText&&(textboxText=void 0===textboxText?"":textboxText,__this.goTo(textboxText))}}}}__createLegend(legend){if(this.__elementLegend.children().remove(),legend){legend.length>0?TcHmi.StyleProvider.setSimpleElementStyle(this.__elementLegend,"display",""):TcHmi.StyleProvider.setSimpleElementStyle(this.__elementLegend,"display","none");for(let i=0,ii=legend.length;i<ii;i++){let label=document.createElement("label");label.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-label"),label.innerText=legend[i].text;let checkbox=document.createElement("input");checkbox.setAttribute("type","checkbox"),checkbox.setAttribute("id",legend[i].id),checkbox.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox");let color=document.createElement("div");color.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-legend-checkbox-color-element"),color.setAttribute("style","background-color: "+legend[i].color+";"),label.append(checkbox),label.append(color),this.__elementLegend.append(label),checkbox.checked=TcHmi.ValueConverter.toBoolean(legend[i].enabled,!1)}}else TcHmi.StyleProvider.setSimpleElementStyle(this.__elementLegend,"display","none")}__createMenuButtons(enableButtons,enableTimes){this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-bar-dropdown").children().detach().appendTo(this.__elementTimeBar);for(let labels in TcHmiScopeControl.TimesEnabled)if(isNaN(Number(labels))){let enumName=labels,addedLabels=(enableTimes&TcHmiScopeControl.TimesEnabled[enumName])===TcHmiScopeControl.TimesEnabled[enumName],timesName=(this.__timeBarControls[enumName],enumName.replace("Label",""));if(addedLabels){if(-1!==enumName.search("Label")){let textValue="";textValue=-1!==enumName.search("Position")?"0,00:00:00,000:000":-1!==enumName.search("Date")?"Label_Text_Date_Placeholder":"00:00:00,000:000";let textblock,existingTextblock=this.__elementTimeBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName);textblock=null!==existingTextblock?$(existingTextblock):$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-textblock"></div>').attr({id:this.__id+"_"+enumName,title:`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${timesName}%/l%`}),this.__elementTimeBar.append(textblock),this.__timeBarControls[enumName]=textblock,this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_"+timesName,textValue),this.__addOrUpdateLocalizedElement(textblock[0],"Tooltip_Text_"+timesName)}else if(-1!==enumName.search("Splitter")){let splitter,existingSplitter=this.__elementTimeBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName);splitter=null!==existingSplitter?$(existingSplitter):$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-splitter"></div>').attr("id",this.__id+"_"+enumName),this.__elementTimeBar.append(splitter),this.__timeBarControls[enumName]=splitter}}else if(!addedLabels){this.__removeLocalizedElement("Label_Text_"+timesName),this.__removeLocalizedElement("Tooltip_Text_"+timesName);let existingControl=this.__elementTimeBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName);if(existingControl)$(existingControl).remove();else{let splitter=this.__elementTimeBar.find("#"+this.__id+"_"+enumName);splitter&&splitter.length>0&&splitter.remove()}delete this.__timeBarControls[enumName]}}if(this.__toolBarControlsArray=[],this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tool-bar-dropdown").children().detach().appendTo(this.__elementToolBar),0===enableButtons||this.__menubar&&!this.__menubar.visibleToolstrip){if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StartRecordButton"))){let elem=this.__toolBarControls.StartRecordButton;elem&&elem.destroy();let destroyEvent=this.__destroyEvents.StartRecordButton;null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StartRecordButton}if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StopRecordButton"))){let elem=this.__toolBarControls.StopRecordButton;elem&&elem.destroy();let destroyEvent=this.__destroyEvents.StopRecordButton;null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StopRecordButton}}else if(this.__enableRecordControls){let controlRecord=TcHmi.Access.checkAccess(this,"controlRecord");null===controlRecord&&(controlRecord=!1);let stopRecordButton=this.__elementToolBar[0].querySelector("#"+this.__id+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StopRecordButton");if(null===stopRecordButton){let buttonStopControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_StopRecordButton",{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StopRecordButton","data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Stop_Record%/l%"},this);if(!buttonStopControl)throw new Error("Needed Button could not be instantiated");buttonStopControl.getElement().prependTo(this.__elementToolBar),buttonStopControl.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!controlRecord),this.__toolBarControls.StopRecordButton=buttonStopControl,this.__toolBarControlsArray.unshift(buttonStopControl),this.__destroyEvents.StopRecordButton=TcHmi.EventProvider.register(this.__id+"_StopRecordButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.unshift($(stopRecordButton));let startRecordButton=this.__elementToolBar[0].querySelector("#"+this.__id+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StartRecordButton");if(null===startRecordButton){let buttonStartControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_StartRecordButton",{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StartRecordButton","data-tchmi-is-enabled":!1,"data-tchmi-tooltip":"%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_Start_Record%/l%"},this);if(!buttonStartControl)throw new Error("Needed Button could not be instantiated");buttonStartControl.getElement().prependTo(this.__elementToolBar),buttonStartControl.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!controlRecord),this.__toolBarControls.StartRecordButton=buttonStartControl,this.__toolBarControlsArray.unshift(buttonStartControl),this.__destroyEvents.StartRecordButton=TcHmi.EventProvider.register(this.__id+"_StartRecordButton.onPressed",this.__onPressed())}else this.__toolBarControlsArray.unshift($(startRecordButton))}else{if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StartRecordButton"))){let elem=this.__toolBarControls.StartRecordButton;elem&&elem.destroy();let destroyEvent=this.__destroyEvents.StartRecordButton;null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StartRecordButton}if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StopRecordButton"))){let elem=this.__toolBarControls.StopRecordButton;elem&&elem.destroy();let destroyEvent=this.__destroyEvents.StopRecordButton;null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StopRecordButton}}for(let button in TcHmiScopeControl.ButtonsEnabled)if(isNaN(Number(button))){let enumName=button,addedButton=(enableButtons&TcHmiScopeControl.ButtonsEnabled[enumName])===TcHmiScopeControl.ButtonsEnabled[enumName];this.__toolBarControls[enumName];if(addedButton){if(-1!==enumName.search("ToggleButton")){let tooltipText=enumName.replace("ToggleButton","");if(null===(this.__elementToolBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName))){let toggleButtonControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiToggleButton",this.__id+"_"+enumName,{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-toggle-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-"+enumName,"data-tchmi-toggle-group":this.__id+"MouseMode","data-tchmi-is-enabled":!1,"data-tchmi-tooltip":`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${tooltipText}%/l%`},this);if(!toggleButtonControl)throw new Error("Needed ToggleButton could not be instantiated");this.__elementToolBar.append(toggleButtonControl.getElement()),this.__toolBarControls[enumName]=toggleButtonControl,this.__toolBarControlsArray.push(toggleButtonControl),this.__destroyEvents[enumName]=TcHmi.EventProvider.register(this.__id+"_"+enumName+".onPressed",this.__onPressed())}else{let existingControlValue=this.__toolBarControls[enumName];existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}else if(-1!==enumName.search("Button")){let tooltipText=enumName.replace("Button","");if(null===(this.__elementToolBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName))){let buttonControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_"+enumName,{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-"+enumName,"data-tchmi-is-enabled":!1,"data-tchmi-tooltip":`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${tooltipText}%/l%`},this);if(!buttonControl)throw new Error("Needed Button could not be instantiated");this.__elementToolBar.append(buttonControl.getElement()),this.__toolBarControls[enumName]=buttonControl,this.__toolBarControlsArray.push(buttonControl),this.__destroyEvents[enumName]=TcHmi.EventProvider.register(this.__id+"_"+enumName+".onPressed",this.__onPressed())}else{let existingControlValue=this.__toolBarControls[enumName];existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}else if(-1!==enumName.search("Splitter")){let splitter,existingSplitter=this.__elementToolBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName);null===existingSplitter?(splitter=$('<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-splitter TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-'+enumName+'"></div>').attr("id",this.__id+"_"+enumName),this.__elementToolBar.append(splitter),this.__toolBarControls[enumName]=splitter):splitter=$(existingSplitter),this.__toolBarControlsArray.push(splitter)}else if(-1!==enumName.search("TextBox")){let tooltipText=enumName.replace("TextBox","");if(null===(this.__elementToolBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName))){let textboxControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiTextbox",this.__id+"_"+enumName,{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-textbox TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-"+enumName,"data-tchmi-text-horizontal-alignment":"Right","data-tchmi-is-enabled":!1,"data-tchmi-tooltip":`%l%Control::TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl::Tooltip_Text_${tooltipText}%/l%`,"data-tchmi-auto-focus-out":!0},this);if(!textboxControl)throw new Error("Needed Textbox could not be instantiated");this.__elementToolBar.append(textboxControl.getElement()),this.__toolBarControls[enumName]=textboxControl,this.__toolBarControlsArray.push(textboxControl),this.__destroyEvents[enumName]=TcHmi.EventProvider.register(this.__id+"_"+enumName+".onUserInteractionFinished",this.__onUserInteractionFinished())}else{let existingControlValue=this.__toolBarControls[enumName];existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}}else if(!addedButton){let existingControl=this.__elementToolBar[0].querySelector("#"+this.__id+"_"+enumName)||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_"+enumName);if(null===existingControl){let splitter=this.__elementToolBar.find("#"+this.__id+"_"+enumName);splitter&&splitter.length>0&&splitter.remove()}else $(existingControl).remove();if(-1!==enumName.search("Button")||-1!==enumName.search("TextBox")||-1!==enumName.search("ToggleButton")){let elem=this.__toolBarControls[enumName];elem&&elem.destroy();let destroyEvent=this.__destroyEvents[enumName];null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0)}delete this.__toolBarControls[enumName]}}if(void 0===this.__toolBarControls.OptionsButton){let optionsButton=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_optionsButton",{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-options","data-tchmi-visibility":"Collapsed"},this);if(!optionsButton)throw new Error("Needed Button could not be instantiated");this.__elementToolBar.append(optionsButton.getElement()),this.__toolBarControls.OptionsButton=optionsButton,this.__toolBarControlsArray.push(optionsButton),this.__destroyEvents.OptionsButton=TcHmi.EventProvider.register(this.__id+"_optionsButton.onPressed",this.__onPressed())}else{let existingControlValue=this.__toolBarControls.OptionsButton;existingControlValue&&this.__toolBarControlsArray.push(existingControlValue)}}__calcMenuButtons(){if(this.__elementToolBar&&this.__elementMenuBarDropdown&&this.__toolBarControlsArray&&this.__timeBarControls){let timeBarDropDown=this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-time-bar-dropdown"),toolBarDropDown=this.__elementMenuBarDropdown.find(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tool-bar-dropdown"),optionsButtonWidth=0,optionsButton=this.__toolBarControls.OptionsButton;if(optionsButton){optionsButton.setVisibility("Visible");let width=optionsButton.getElement().outerWidth(!0);optionsButtonWidth=void 0===width?0:width}let menuBarWidth=this.__elementToolBar.width(),actualWidth=optionsButtonWidth;for(let i=0,ii=this.__toolBarControlsArray.length;i<ii;i++){let control=this.__toolBarControlsArray[i];if(control){let width;if(control instanceof jQuery){width=control.outerWidth(!0)}else if(control instanceof TcHmi.Controls.System.baseTcHmiControl){let baseControl=control;-1===baseControl.getId().search("optionsButton")&&(width=baseControl.getElement().outerWidth(!0))}if(void 0===width&&(width=0),actualWidth+=width,actualWidth>=menuBarWidth)if(control instanceof jQuery)toolBarDropDown.append(control[0]);else if(control instanceof TcHmi.Controls.System.baseTcHmiControl){let baseControl=control;-1===baseControl.getId().search("optionsButton")&&toolBarDropDown.append(baseControl.getElement())}}}actualWidth=optionsButtonWidth;for(let controlName in this.__timeBarControls){let control=this.__timeBarControls[controlName];if(void 0!==control){let width=control.outerWidth(!0);void 0===width&&(width=0),actualWidth+=width,actualWidth>=menuBarWidth&&timeBarDropDown.append(control[0])}}timeBarDropDown.children().length>0||toolBarDropDown.children().length>0?optionsButton&&optionsButton.setVisibility("Visible"):optionsButton&&optionsButton.setVisibility("Collapsed")}}__enableOrDisableMenuControls(scopeState,live,undo,redo,chartType){let controlRecord=TcHmi.Access.checkAccess(this,"controlRecord");switch(null===controlRecord&&(controlRecord=!1),scopeState){case"Unknown":case"Config":case"Connected":for(let controlName in this.__toolBarControls){let control=this.__toolBarControls[controlName];control instanceof TcHmi.Controls.System.baseTcHmiControl&&control.setIsEnabled(!1)}this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!!controlRecord),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!1),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Running":for(let controlName in this.__toolBarControls){let control=this.__toolBarControls[controlName];control instanceof TcHmi.Controls.System.baseTcHmiControl&&control.setIsEnabled(!1)}this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!1),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!!controlRecord),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Record":this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!1),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!!controlRecord),this.__toolBarControls.RunButton&&this.__toolBarControls.RunButton.setIsEnabled(!live),this.__toolBarControls.PauseButton&&this.__toolBarControls.PauseButton.setIsEnabled(live),this.__toolBarControls.DisplaywidthTextBox&&this.__toolBarControls.DisplaywidthTextBox.setIsEnabled(!0),this.__toolBarControls.ScrollBackBigButton&&this.__toolBarControls.ScrollBackBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardBigButton&&this.__toolBarControls.ScrollForwardBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollBackSmallButton&&this.__toolBarControls.ScrollBackSmallButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardSmallButton&&this.__toolBarControls.ScrollForwardSmallButton.setIsEnabled(!live),this.__toolBarControls.GotoTextBox&&this.__toolBarControls.GotoTextBox.setIsEnabled(!live),this.__toolBarControls.UndoButton&&this.__toolBarControls.UndoButton.setIsEnabled(!live&&undo),this.__toolBarControls.RedoButton&&this.__toolBarControls.RedoButton.setIsEnabled(!live&&redo),this.__toolBarControls.ZoomToggleButton&&this.__toolBarControls.ZoomToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl.ChartType.ArrayBarChart),this.__toolBarControls.ZoomXYToggleButton&&this.__toolBarControls.ZoomXYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl.ChartType.ArrayBarChart),this.__toolBarControls.PanXYToggleButton&&this.__toolBarControls.PanXYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl.ChartType.ArrayBarChart||chartType===TcHmiScopeControl.ChartType.XY),this.__toolBarControls.PanToggleButton&&this.__toolBarControls.PanToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl.ChartType.ArrayBarChart),this.__toolBarControls.ZoomYToggleButton&&this.__toolBarControls.ZoomYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl.ChartType.ArrayBarChart),this.__toolBarControls.PanYToggleButton&&this.__toolBarControls.PanYToggleButton.setIsEnabled(!live||chartType===TcHmiScopeControl.ChartType.ArrayBarChart),this.__toolBarControls.OverviewButton&&this.__toolBarControls.OverviewButton.setIsEnabled(!0),this.__toolBarControls.UnzoomButton&&this.__toolBarControls.UnzoomButton.setIsEnabled(!0),this.__toolBarControls.ZoomOutMaxButton&&this.__toolBarControls.ZoomOutMaxButton.setIsEnabled(!0),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;case"Reply":this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.setIsEnabled(!!controlRecord),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.setIsEnabled(!1),this.__toolBarControls.RunButton&&this.__toolBarControls.RunButton.setIsEnabled(!1),this.__toolBarControls.PauseButton&&this.__toolBarControls.PauseButton.setIsEnabled(!1),this.__toolBarControls.DisplaywidthTextBox&&this.__toolBarControls.DisplaywidthTextBox.setIsEnabled(!0),this.__toolBarControls.ScrollBackBigButton&&this.__toolBarControls.ScrollBackBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardBigButton&&this.__toolBarControls.ScrollForwardBigButton.setIsEnabled(!live),this.__toolBarControls.ScrollBackSmallButton&&this.__toolBarControls.ScrollBackSmallButton.setIsEnabled(!live),this.__toolBarControls.ScrollForwardSmallButton&&this.__toolBarControls.ScrollForwardSmallButton.setIsEnabled(!live),this.__toolBarControls.GotoTextBox&&this.__toolBarControls.GotoTextBox.setIsEnabled(!live),this.__toolBarControls.UndoButton&&this.__toolBarControls.UndoButton.setIsEnabled(!live&&undo),this.__toolBarControls.RedoButton&&this.__toolBarControls.RedoButton.setIsEnabled(!live&&redo),this.__toolBarControls.ZoomToggleButton&&this.__toolBarControls.ZoomToggleButton.setIsEnabled(!live),this.__toolBarControls.ZoomXYToggleButton&&this.__toolBarControls.ZoomXYToggleButton.setIsEnabled(!live),this.__toolBarControls.PanToggleButton&&this.__toolBarControls.PanToggleButton.setIsEnabled(!live),this.__toolBarControls.PanXYToggleButton&&this.__toolBarControls.PanXYToggleButton.setIsEnabled(!live),this.__toolBarControls.ZoomYToggleButton&&this.__toolBarControls.ZoomYToggleButton.setIsEnabled(!live),this.__toolBarControls.PanYToggleButton&&this.__toolBarControls.PanYToggleButton.setIsEnabled(!live),this.__toolBarControls.UnzoomButton&&this.__toolBarControls.UnzoomButton.setIsEnabled(!0),this.__toolBarControls.ZoomOutMaxButton&&this.__toolBarControls.ZoomOutMaxButton.setIsEnabled(!0),this.__toolBarControls.OverviewButton&&this.__toolBarControls.OverviewButton.setIsEnabled(!0),this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0);break;default:for(let controlName in this.__toolBarControls){let control=this.__toolBarControls[controlName];control instanceof TcHmi.Controls.System.baseTcHmiControl&&"OptionsButton"!==controlName&&control.setIsEnabled(!1)}this.__toolBarControls.OptionsButton&&this.__toolBarControls.OptionsButton.setIsEnabled(!0)}}__updatedMenuValues(windowData){for(let controlName in this.__timeBarControls)if(-1===controlName.search("Splitter")){let textblock=this.__timeBarControls[controlName];if(-1!==controlName.search("StartTime")){let textValue="";if(windowData&&windowData.xAxisStart){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.xAxisStart));textValue=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}else textValue="00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_StartTime",textValue)}else if(-1!==controlName.search("EndTime")){let textValue="";if(windowData&&windowData.xAxisEnd){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.xAxisEnd));textValue=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}else textValue="00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_EndTime",textValue)}else if(-1!==controlName.search("Position")){let textValue="";if(windowData&&windowData.xAxisPosition){textValue=this.__isoToScopeString(windowData.xAxisPosition)}else textValue="0,00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_Position",textValue)}else if(-1!==controlName.search("AbsTime")){let textValue="";if(windowData&&windowData.startDisplayTime){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.startDisplayTime));textValue=("00"+dateSplitted.hour).slice(-2)+":"+("00"+dateSplitted.minute).slice(-2)+":"+("00"+dateSplitted.second).slice(-2)+","+("000"+dateSplitted.millisecond).slice(-3)}else textValue="00:00:00,000:000";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_AbsTime",textValue)}else if(-1!==controlName.search("Date")){let textValue="";if(windowData&&windowData.startDisplayTime){const dateSplitted=TcHmi.Localization.parseDate(new Date(windowData.startDisplayTime));let d=new Date;textValue=d.toLocaleString(TcHmi.Server.getCurrentUserConfig().timeFormatLocale,{weekday:"long"})+", "+dateSplitted.day+". "+d.toLocaleString(TcHmi.Server.getCurrentUserConfig().timeFormatLocale,{month:"long"})+" "+dateSplitted.year}else textValue="Label_Text_Date_Placeholder";this.__addOrUpdateLocalizedElement(textblock[0],"Label_Text_Date",textValue)}}for(let controlName in this.__toolBarControls)if(-1!==controlName.search("DisplaywidthTextBox")){let textbox=this.__toolBarControls[controlName];if(windowData&&windowData.displayWidth){let scopeString=this.__isoToScopeString(windowData.displayWidth);textbox.setText(scopeString),this.__displayWidthText=scopeString}else textbox.setText("0,00:00:00,000:000")}else if(-1!==controlName.search("GotoTextBox")){let textbox=this.__toolBarControls[controlName];if(windowData&&windowData.xAxisPosition){let scopeString=this.__isoToScopeString(windowData.xAxisPosition);textbox.setText(scopeString),this.__gotoText=scopeString}else textbox.setText("0,00:00:00,000:000")}}showOptions(){null===this.__elementMenuBarDropdown[0].parentElement?TcHmi.TopMostLayer.add(this,this.__elementMenuBarDropdown,{centerHorizontal:!0,centerVertical:!0}):TcHmi.TopMostLayer.remove(this,this.__elementMenuBarDropdown)}__transformEventCoords(clientX,clientY,targetElement){if(targetElement){let renderedWidth=this.getRenderedWidth(),renderedHeight=this.getRenderedHeight();if(null===renderedWidth||null===renderedHeight)return{x:0,y:0};let controlRect=this.__element[0].getBoundingClientRect();this.__scaling={x:renderedWidth/controlRect.width,y:renderedHeight/controlRect.height}}return{x:clientX*this.__scaling.x,y:clientY*this.__scaling.y}}__onMouseDown(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__tooltipTimeout&&(clearTimeout(this.__tooltipTimeout),this.__tooltipTimeout=null,this.__elementTooltip.css("visibility","hidden")),this.__manipulationInfo.isManipulating)return;if(!this.getIsEnabled())return;this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0};let boundingRect=e.target.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),parentElement=e.currentTarget.parentElement;if(parentElement){let index=-1;if(parentElement!==this.__elementOverview[0]&&(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement)),this.__scopeLayout){let x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__scopeLayout.showTooltip&&index>-1&&this.__scopeGraphWindow&&!this.__scopeGraphWindow.liveState&&x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&this.__scopeGraphData&&this.__scopeGraphData.charts)for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++)if(i===index&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key];if(graph){let tooltipDelta=graph.tooltipDelta;if(graph.axesData.filter(item=>x>=item.x-tooltipDelta&&x<=item.x+tooltipDelta&&y>=item.y-tooltipDelta&&y<=item.y+tooltipDelta).length>0){this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y};let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:this.__serverDomain+".GetTooltip",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,chartIndex:index,mousePosition:{x:x,y:y}}}]};return this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__getTooltipRequestId),void(this.__getTooltipRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__getDataCallback()))}}}if(-1===index)this.__scopeLayout.overview&&x>=this.__scopeLayout.overview.canvas.position.x&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeLayout.overview.canvas.dimensions.width&&y>=this.__scopeLayout.overview.canvas.position.y&&y<=this.__scopeLayout.overview.canvas.position.y+this.__scopeLayout.overview.canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index));else{if(this.__scopeGraphWindow&&this.__scopeGraphWindow.liveState)return;x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index))}}}}}__onMouseDownGlobal(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__manipulationInfo.isManipulating)return;if(!this.getIsEnabled())return;this.__tooltipTimeout&&(clearTimeout(this.__tooltipTimeout),this.__tooltipTimeout=null,this.__elementTooltip.css("visibility","hidden")),this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0};let boundingRect=this.__elementBorder[0].getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__resizeLines.length>0)for(let i=0,ii=this.__resizeLines.length;i<ii;i++)if(this.__resizeLines[i].orientation===TcHmiScopeControl.Orientation.Horizontal){if(y>=this.__resizeLines[i].startPoint.y-5&&y<=this.__resizeLines[i].endPoint.y+5)return void(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:this.__resizeLines[i].chartIndex,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!0,resizeLineIndex:i,touchIdentifier:0})}else if(this.__resizeLines[i].orientation===TcHmiScopeControl.Orientation.Vertical&&x>=this.__resizeLines[i].startPoint.x-5&&x<=this.__resizeLines[i].endPoint.x+5)return void(this.__manipulationInfo={isManipulating:!0,start:{x:x,y:y},end:{x:x,y:y},offset:{left:boundingRect.left,top:boundingRect.top},transform:{x:0,y:0},click:!0,mousePosition:{x:x,y:y},elementIndex:this.__resizeLines[i].chartIndex,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!0,resizeLineIndex:i,touchIdentifier:0})}}__onMouseMove(){return e=>{if(!this.__manipulationInfo.isManipulating||!this.getIsEnabled())return;let coords=this.__transformEventCoords(e.clientX,e.clientY),x=coords.x-this.__manipulationInfo.offset.left,y=coords.y-this.__manipulationInfo.offset.top;this.__userInteractionMove(x,y)}}__onMouseMoveChangeCursor(){return e=>{if(this.__elementChartings.css("cursor","default"),!this.__manipulationInfo.isManipulating&&this.getIsEnabled()&&this.__scopeLayout){if(this.__resizeLines.length>0){let boundingRect=this.__elementBorder[0].getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;for(let i=0,ii=this.__resizeLines.length;i<ii;i++)if(this.__resizeLines[i].orientation===TcHmiScopeControl.Orientation.Horizontal){if(y>=this.__resizeLines[i].startPoint.y-5&&y<=this.__resizeLines[i].endPoint.y+5)return void this.__elementChartings.css("cursor","ns-resize")}else if(this.__resizeLines[i].orientation===TcHmiScopeControl.Orientation.Vertical&&x>=this.__resizeLines[i].startPoint.x-5&&x<=this.__resizeLines[i].endPoint.x+5)return void this.__elementChartings.css("cursor","ew-resize")}if(this.__scopeGraphWindow&&this.__scopeGraphWindow.liveState)return;let target=e.target;if(-1!==target.className.search("tchmi-chart-canvas-zooming")){let parentElement=target.parentElement;if(parentElement){let boundingRect=parentElement.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY),x=coords.x-boundingRect.left,y=coords.y-boundingRect.top,index=-1;if(parentElement===this.__elementOverview[0])return;if(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement),-1!==index&&x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height){if(this.__scopeLayout.showTooltip&&this.__scopeGraphData&&this.__scopeGraphData.charts)for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++)if(i===index&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key];if(graph){let tooltipDelta=graph.tooltipDelta,axesData=graph.axesData;if(axesData){if(axesData.filter(item=>x>=item.x-tooltipDelta&&x<=item.x+tooltipDelta&&y>=item.y-tooltipDelta&&y<=item.y+tooltipDelta).length>0)return void this.__elementChartings.css("cursor","pointer")}}}if(this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomXY)return void this.__elementChartings.css("cursor","crosshair");if(this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomY)return void this.__elementChartings.css("cursor","crosshair");if(this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomX)return void this.__elementChartings.css("cursor","crosshair");if(this.__mouseMode===TcHmiScopeControl.MouseMode.PanXY)return void this.__elementChartings.css("cursor","move");if(this.__mouseMode===TcHmiScopeControl.MouseMode.PanY)return void this.__elementChartings.css("cursor","ns-resize");if(this.__mouseMode===TcHmiScopeControl.MouseMode.PanX)return void this.__elementChartings.css("cursor","ew-resize")}}}}}}__onMouseMoveOverview(){return e=>{if(this.getIsEnabled())if(this.__overviewRectangle){let coords=this.__transformEventCoords(e.offsetX,e.offsetY);coords.x>=this.__overviewRectangle.position.x-3&&coords.x<=this.__overviewRectangle.position.x+3&&coords.y>=this.__overviewRectangle.position.y&&coords.y<=this.__overviewRectangle.position.y+this.__overviewRectangle.dimensions.height||coords.x>=this.__overviewRectangle.position.x+this.__overviewRectangle.dimensions.width-3&&coords.x<=this.__overviewRectangle.position.x+this.__overviewRectangle.dimensions.width+3&&coords.y>=this.__overviewRectangle.position.y&&coords.y<=this.__overviewRectangle.position.y+this.__overviewRectangle.dimensions.height?this.__elementOverview.css("cursor","ew-resize"):coords.x>=this.__overviewRectangle.position.x+3&&coords.x<=this.__overviewRectangle.position.x+this.__overviewRectangle.dimensions.width-3&&coords.y>=this.__overviewRectangle.position.y&&coords.y<=this.__overviewRectangle.position.y+this.__overviewRectangle.dimensions.height?this.__elementOverview.css("cursor","move"):this.__elementOverview.css("cursor","")}else this.__elementOverview.css("cursor","")}}__onMouseUp(){return e=>{this.__manipulationInfo.isManipulating&&this.getIsEnabled()&&this.__userInteractionEnd()}}__onMouseWheel(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__manipulationInfo.isManipulating||this.__multitouchInfo.multitouchMode)return;if(!this.getIsEnabled())return;if(null!==this.__wheelRequestId)return;e.preventDefault();let boundingRect=e.target.getBoundingClientRect(),coords=this.__transformEventCoords(e.clientX,e.clientY,e.target),parentElement=e.currentTarget.parentElement;if(parentElement){let index=-1;if(parentElement!==this.__elementOverview[0]&&(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement)),this.__scopeLayout&&index>-1){let x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height){let delta;switch(this.__wheelInfo.isWheeling=!0,this.__wheelInfo.mousePosition={x:x,y:y},e.deltaMode){case WheelEvent.DOM_DELTA_PAGE:delta=800*-e.deltaY;break;case WheelEvent.DOM_DELTA_LINE:delta=40*-e.deltaY;break;case WheelEvent.DOM_DELTA_PIXEL:default:delta=-e.deltaY}if(delta=Math.max(-1,Math.min(1,delta)),this.__wheelInfo.wheelSteps=this.__wheelInfo.wheelSteps+delta,this.__wheelInfo.timeout)return;let __this=this;this.__wheelInfo.timeout=setTimeout((function(){if(null!==__this.__subscriptionId&&__this.__mouseMode){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:__this.__serverDomain+".Wheel",writeValue:{controlName:__this.__id,scopeConfig:__this.__scopeConfig,wheel:{chartIndex:index,delta:__this.__wheelInfo.wheelSteps,mouseMode:TcHmiScopeControl.MouseMode[__this.__mouseMode],mousePosition:{x:x,y:y}}}}]};__this.__loadingSpinner&&__this.__elementLoading[0].appendChild(__this.__loadingSpinner),__this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(__this.__wheelRequestId),__this.__wheelRequestId=TcHmi.Server.request(request,__this.__getDataCallback())}__this.__wheelInfo.timeout&&(clearTimeout(__this.__wheelInfo.timeout),__this.__wheelInfo.timeout=0),__this.__wheelInfo={isWheeling:!1,wheelSteps:0,mousePosition:{x:0,y:0},timeout:0}}),300)}}}}}__onTouchStart(){return e=>{if(!TcHmi.Access.checkAccess(this,"operate"))return;if(this.__tooltipTimeout&&(clearTimeout(this.__tooltipTimeout),this.__tooltipTimeout=null,this.__elementTooltip.css("visibility","hidden")),!this.getIsEnabled())return;e.preventDefault(),this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0};let boundingRect=e.target.getBoundingClientRect(),touch=e.touches[0],coords=this.__transformEventCoords(touch.clientX,touch.clientY,e.target);if(this.__manipulationInfo.isManipulating)return;let parentElement=e.currentTarget.parentElement;if(parentElement){let index=-1;if(parentElement!==this.__elementOverview[0]&&(index=Array.prototype.slice.call(this.__elementChartings.children(".TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-chart")).indexOf(parentElement)),this.__scopeLayout){let x=coords.x-boundingRect.left,y=coords.y-boundingRect.top;if(this.__scopeLayout.showTooltip&&index>-1&&this.__scopeGraphWindow&&!this.__scopeGraphWindow.liveState&&x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&this.__scopeGraphData&&this.__scopeGraphData.charts)for(let i=0,ii=this.__scopeGraphData.charts.length;i<ii;i++)if(i===index&&this.__scopeGraphData.charts[i]&&this.__scopeGraphData.charts[i].graphs)for(let key in this.__scopeGraphData.charts[i].graphs){let graph=this.__scopeGraphData.charts[i].graphs[key];if(graph){let tooltipDelta=graph.tooltipDelta;if(graph.axesData.filter(item=>x>=item.x-tooltipDelta&&x<=item.x+tooltipDelta&&y>=item.y-tooltipDelta&&y<=item.y+tooltipDelta).length>0){this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y};let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:this.__serverDomain+".GetTooltip",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,chartIndex:index,mousePosition:{x:x,y:y}}}]};return this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__getTooltipRequestId),void(this.__getTooltipRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__getDataCallback()))}}}if(-1===index)this.__scopeLayout.overview&&x>=this.__scopeLayout.overview.canvas.position.x&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeLayout.overview.canvas.dimensions.width&&y>=this.__scopeLayout.overview.canvas.position.y&&y<=this.__scopeLayout.overview.canvas.position.y+this.__scopeLayout.overview.canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index));else{if(this.__scopeGraphWindow&&this.__scopeGraphWindow.liveState)return;x>=this.__scopeLayout.charts[index].canvas.position.x&&x<=this.__scopeLayout.charts[index].canvas.position.x+this.__scopeLayout.charts[index].canvas.dimensions.width&&y>=this.__scopeLayout.charts[index].canvas.position.y&&y<=this.__scopeLayout.charts[index].canvas.position.y+this.__scopeLayout.charts[index].canvas.dimensions.height&&(this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.offset.left=boundingRect.left,this.__manipulationInfo.offset.top=boundingRect.top,this.__manipulationInfo.mousePosition={x:x,y:y},this.__userInteractionStart(x,y,index))}}}}}__onTouchMove(){return e=>{if(this.getIsEnabled()&&this.__manipulationInfo.isManipulating){let touch=e.touches[0],coords=this.__transformEventCoords(touch.clientX,touch.clientY),x=coords.x-this.__manipulationInfo.offset.left,y=coords.y-this.__manipulationInfo.offset.top;Math.sqrt(Math.pow(this.__manipulationInfo.mousePosition.x-x,2)+Math.pow(this.__manipulationInfo.mousePosition.y-y,2))>5&&this.__userInteractionMove(x,y)}}}__onTouchEnd(){return e=>{if(this.getIsEnabled()&&this.__manipulationInfo.isManipulating){let touch=e.changedTouches[0],coords=this.__transformEventCoords(touch.clientX,touch.clientY),x=coords.x-this.__manipulationInfo.offset.left,y=coords.y-this.__manipulationInfo.offset.top;Math.sqrt(Math.pow(this.__manipulationInfo.mousePosition.x-x,2)+Math.pow(this.__manipulationInfo.mousePosition.y-y,2))>5?this.__userInteractionEnd():this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0}}}}__userInteractionStart(x,y,position){if(this.__scopeLayout)if(-1===position){if(this.__scopeLayout.overview&&this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect){if(x<this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x-3||x>this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+this.__scopeGraphWindow.overviewRect.dimensions.width+3||y<this.__scopeLayout.overview.canvas.position.y||y>this.__scopeLayout.overview.canvas.position.y+this.__scopeGraphWindow.overviewRect.dimensions.height)return void(this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0});x>=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x-3&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+3?(this.__manipulationInfo.isOverviewSizeChanged=!0,this.__manipulationInfo.beginOverviewRectChanging=!0):x>=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+this.__scopeGraphWindow.overviewRect.dimensions.width-3&&x<=this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+this.__scopeGraphWindow.overviewRect.dimensions.width+3&&(this.__manipulationInfo.isOverviewSizeChanged=!0,this.__manipulationInfo.beginOverviewRectChanging=!1),this.__manipulationInfo.start.x=x,this.__manipulationInfo.start.y=y,this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y,this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.transform={x:0,y:0},this.__manipulationInfo.elementIndex=position}}else{let offsetTop=this.__scopeLayout.charts[position].canvas.position.y,offsetLeft=this.__scopeLayout.charts[position].canvas.position.x,xLineWidth=this.__scopeLayout.charts[position].canvas.dimensions.width,yLineHeight=this.__scopeLayout.charts[position].canvas.dimensions.height;if(x<offsetLeft||x>offsetLeft+xLineWidth||y<offsetTop||y>offsetTop+yLineHeight)return;this.__mouseMode!==TcHmiScopeControl.MouseMode.ZoomX&&this.__mouseMode!==TcHmiScopeControl.MouseMode.ZoomXY&&this.__mouseMode!==TcHmiScopeControl.MouseMode.ZoomY||(this.__manipulationInfo.start.x=x,this.__manipulationInfo.start.y=y,this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y,this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomX?(this.__manipulationInfo.start.y=offsetTop,this.__manipulationInfo.end.y=offsetTop):this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomY&&(this.__manipulationInfo.start.x=offsetLeft,this.__manipulationInfo.end.x=offsetLeft)),this.__mouseMode!==TcHmiScopeControl.MouseMode.PanX&&this.__mouseMode!==TcHmiScopeControl.MouseMode.PanXY&&this.__mouseMode!==TcHmiScopeControl.MouseMode.PanY||(this.__manipulationInfo.start.x=x,this.__manipulationInfo.start.y=y,this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y),this.__manipulationInfo.isManipulating=!0,this.__manipulationInfo.transform={x:0,y:0},this.__manipulationInfo.elementIndex=position}}__userInteractionMove(x,y){if(!0===this.__manipulationInfo.chartSizeChanged){let dX=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x,dY=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,canvasBorderElem=this.__elementBorder[0],contextBorderElem=canvasBorderElem.getContext("2d");if(contextBorderElem&&this.__scopeLayout){if(contextBorderElem.clearRect(0,0,canvasBorderElem.width,canvasBorderElem.height),-1===this.__resizeLines[this.__manipulationInfo.resizeLineIndex].chartIndex){this.__themeChartForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.Theme?contextBorderElem.strokeStyle=this.__themeChartForegroundColor:contextBorderElem.strokeStyle=this.__scopeLayout.foregroundColor,contextBorderElem.lineWidth=2,contextBorderElem.beginPath();let i=this.__manipulationInfo.resizeLineIndex;if(this.__scopeLayout.overview){let overviewElemHeight=this.__scopeLayout.overview.dimensions.height+dY,overviewMinHeight=this.__scopeLayout.overview.preferredSize.height,positionFromFirstChart=this.__chartingElements[0].position().top,chartsElemHeight=canvasBorderElem.height-positionFromFirstChart-dY,chartsMinHeight=10,newdY=overviewElemHeight>=overviewMinHeight?dY:overviewMinHeight-this.__scopeLayout.overview.dimensions.height;newdY=chartsElemHeight>=chartsMinHeight?newdY:canvasBorderElem.height-chartsMinHeight-positionFromFirstChart,contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y+newdY),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y+newdY),contextBorderElem.stroke()}}this.__themeChartForegroundColor&&this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.Theme?contextBorderElem.strokeStyle=this.__themeChartForegroundColor:contextBorderElem.strokeStyle=this.__scopeLayout.foregroundColor,contextBorderElem.lineWidth=1,contextBorderElem.beginPath();for(let i=0,ii=this.__resizeLines.length;i<ii;i++)if(-1!==this.__resizeLines[i].chartIndex)if(i===this.__manipulationInfo.resizeLineIndex)if(TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]===TcHmiScopeControl.ChartType.SingleBarChart)if(this.__resizeLines[i].orientation===TcHmiScopeControl.Orientation.Horizontal){let resizeLineUnderIndex=this.__resizeLines.slice(0,this.__manipulationInfo.resizeLineIndex),searchedOrientation=this.__resizeLines[this.__manipulationInfo.resizeLineIndex].orientation,allFoundedOrientation=resizeLineUnderIndex.filter(elem=>elem.orientation===searchedOrientation),indexOfFirstElem=this.__manipulationInfo.elementIndex;0===allFoundedOrientation.length?indexOfFirstElem-=1:indexOfFirstElem=allFoundedOrientation[allFoundedOrientation.length-1].chartIndex;let firstElems=this.__scopeLayout.charts.filter(elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y-this.__scopeLayout.charts[indexOfFirstElem].dimensions.height),secondElems=this.__scopeLayout.charts.filter(elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y),firstElemMinHeight=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinHeight?firstElems[j].preferredSize.height>firstElemMinHeight&&(firstElemMinHeight=firstElems[j].preferredSize.height):firstElemMinHeight=firstElems[j].preferredSize.height;null===firstElemMinHeight&&(firstElemMinHeight=0);let secondElemMinHeight=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinHeight?secondElems[k].preferredSize.height>secondElemMinHeight&&(secondElemMinHeight=secondElems[k].preferredSize.height):secondElemMinHeight=secondElems[k].preferredSize.height;null===secondElemMinHeight&&(secondElemMinHeight=0);let newDY=firstElems[0].dimensions.height+dY>=firstElemMinHeight?dY:firstElemMinHeight-firstElems[0].dimensions.height;secondElems.length>0&&(newDY=secondElems[0].dimensions.height-dY>=secondElemMinHeight?newDY:secondElems[0].dimensions.height-secondElemMinHeight),contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y+newDY),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y+newDY)}else{let firstElems=this.__scopeLayout.charts.filter(elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x),secondElems=this.__scopeLayout.charts.filter(elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x+this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.width),firstElemMinWidth=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinWidth?firstElems[j].preferredSize.width>firstElemMinWidth&&(firstElemMinWidth=firstElems[j].preferredSize.width):firstElemMinWidth=firstElems[j].preferredSize.width;null===firstElemMinWidth&&(firstElemMinWidth=0);let secondElemMinWidth=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinWidth?secondElems[k].preferredSize.width>secondElemMinWidth&&(secondElemMinWidth=secondElems[k].preferredSize.width):secondElemMinWidth=secondElems[k].preferredSize.width;null===secondElemMinWidth&&(secondElemMinWidth=0);let newDX=firstElems[0].dimensions.width+dX>=firstElemMinWidth?dX:firstElemMinWidth-firstElems[0].dimensions.width;if(secondElems.length>0)newDX=secondElems[0].dimensions.width-dX>=secondElemMinWidth?newDX:secondElems[0].dimensions.width-secondElemMinWidth;else{let elemEndPosition=firstElems[0].position.x+firstElems[0].dimensions.width;elemEndPosition+newDX>this.__scopeLayout.dimensions.width&&(newDX=this.__scopeLayout.dimensions.width-elemEndPosition)}contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x+newDX,this.__resizeLines[i].startPoint.y),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x+newDX,this.__resizeLines[i].endPoint.y)}else{let firstElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height+dY,secondElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-dY;if(this.__resizeLines[i].orientation===TcHmiScopeControl.Orientation.Horizontal){let firstElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].preferredSize.height,secondElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].preferredSize.height,newDY=firstElemHeight>=firstElemMinHeight?dY:firstElemMinHeight-this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height;newDY=secondElemHeight>=secondElemMinHeight?newDY:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-secondElemMinHeight,contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y+newDY),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y+newDY)}}else contextBorderElem.moveTo(this.__resizeLines[i].startPoint.x,this.__resizeLines[i].startPoint.y),contextBorderElem.lineTo(this.__resizeLines[i].endPoint.x,this.__resizeLines[i].endPoint.y);contextBorderElem.stroke()}}else if(-1===this.__manipulationInfo.elementIndex){if(!(this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect&&this.__scopeLayout&&this.__scopeLayout.overview&&this.__overviewChart))return;let context=this.__overviewChart.getCanvasZooming().getContext("2d");if(null===context)return;let width=x-this.__manipulationInfo.start.x;if(this.__manipulationInfo.isOverviewSizeChanged)if(this.__manipulationInfo.beginOverviewRectChanging){let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width-width;newWidth<5&&(newWidth=5),context.clearRect(0,0,context.canvas.width,context.canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+width,this.__scopeLayout.overview.canvas.position.y,newWidth,this.__scopeGraphWindow.overviewRect.dimensions.height)}else{let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width+width;newWidth<5&&(newWidth=5),context.clearRect(0,0,context.canvas.width,context.canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x,this.__scopeLayout.overview.canvas.position.y,newWidth,this.__scopeGraphWindow.overviewRect.dimensions.height)}else context.clearRect(0,0,context.canvas.width,context.canvas.height),context.fillStyle="rgba(51,153,255,0.3)",context.fillRect(this.__scopeLayout.overview.canvas.position.x+this.__scopeGraphWindow.overviewRect.position.x+width,this.__scopeLayout.overview.canvas.position.y,this.__scopeGraphWindow.overviewRect.dimensions.width,this.__scopeGraphWindow.overviewRect.dimensions.height)}else if(this.__scopeLayout&&this.__lineCharts){let position=this.__manipulationInfo.elementIndex,lineChart=this.__lineCharts[position];if(lineChart){let context=lineChart.getCanvasZooming().getContext("2d"),offsetTop=this.__scopeLayout.charts[position].canvas.position.y,offsetLeft=this.__scopeLayout.charts[position].canvas.position.x,xLineWidth=this.__scopeLayout.charts[position].canvas.dimensions.width,yLineHeight=this.__scopeLayout.charts[position].canvas.dimensions.height;if(this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomX||this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomXY||this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomY){if(null===context)return;let width=x-this.__manipulationInfo.start.x,height=0;this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomX?height=yLineHeight:this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomY?(width=xLineWidth,height=y-this.__manipulationInfo.start.y):height=y-this.__manipulationInfo.start.y,context.clearRect(0,0,context.canvas.width,context.canvas.height),context.beginPath(),context.rect(this.__manipulationInfo.start.x,this.__manipulationInfo.start.y,width,height),context.fillStyle="rgba(51,153,255,0.3)",context.fill(),context.clearRect(0,0,context.canvas.width,offsetTop),context.clearRect(0,0,offsetLeft,context.canvas.height),context.clearRect(0,context.canvas.height,context.canvas.width,-(context.canvas.height-yLineHeight-offsetTop)),context.clearRect(context.canvas.width,0,-(context.canvas.width-offsetLeft-xLineWidth),context.canvas.height)}if(this.__mouseMode===TcHmiScopeControl.MouseMode.PanX||this.__mouseMode===TcHmiScopeControl.MouseMode.PanXY||this.__mouseMode===TcHmiScopeControl.MouseMode.PanY){let dX=x-this.__manipulationInfo.end.x,dY=y-this.__manipulationInfo.end.y,drawingCanvas=lineChart.getCanvasDrawing();if(drawingCanvas){let drawingContext=drawingCanvas.getContext("2d");if(null===context||null===drawingContext)return;drawingContext.setTransform(1,0,0,1,0,0),drawingContext.clearRect(0,0,drawingCanvas.width,drawingCanvas.height),this.__mouseMode===TcHmiScopeControl.MouseMode.PanXY?(drawingContext.translate(this.__manipulationInfo.transform.x+dX,this.__manipulationInfo.transform.y+dY),this.__manipulationInfo.transform={x:this.__manipulationInfo.transform.x+dX,y:this.__manipulationInfo.transform.y+dY}):this.__mouseMode===TcHmiScopeControl.MouseMode.PanY?(drawingContext.translate(0,this.__manipulationInfo.transform.y+dY),this.__manipulationInfo.transform.y=this.__manipulationInfo.transform.y+dY):(drawingContext.translate(this.__manipulationInfo.transform.x+dX,0),this.__manipulationInfo.transform.x=this.__manipulationInfo.transform.x+dX),lineChart.setLineChanged(!0),this.__chartChartColorSource===TcHmiScopeControl.ChartColorSource.ScopeConfig?lineChart.draw(this.__scopeLayout.charts[position],null):lineChart.draw(this.__scopeLayout.charts[position],this.__themeCanvasBackgroundColor)}}}}this.__manipulationInfo.end.x=x,this.__manipulationInfo.end.y=y}__userInteractionEnd(){if(this.__manipulationInfo.chartSizeChanged){if(this.__scopeLayout)if(-1===this.__manipulationInfo.elementIndex){let canvasBorderElem=this.__elementBorder[0];if(this.__scopeLayout.overview&&canvasBorderElem){let diff=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,overviewElemHeight=this.__scopeLayout.overview.dimensions.height+diff,overviewMinHeight=this.__scopeLayout.overview.preferredSize.height,positionFromFirstChart=this.__chartingElements[0].position().top,chartsElemHeight=canvasBorderElem.height-positionFromFirstChart-diff,chartsMinHeight=10,newDiff=overviewElemHeight>=overviewMinHeight?diff:overviewMinHeight-this.__scopeLayout.overview.dimensions.height;if(newDiff=chartsElemHeight>=chartsMinHeight?newDiff:canvasBorderElem.height-chartsMinHeight-positionFromFirstChart,null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,resizeOverview:!0,charts:[{chartIndex:-1,width:this.__scopeLayout.overview.dimensions.width,height:this.__scopeLayout.overview.dimensions.height+newDiff}]}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}}else if(TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]===TcHmiScopeControl.ChartType.SingleBarChart)if(this.__resizeLines[this.__manipulationInfo.resizeLineIndex].orientation===TcHmiScopeControl.Orientation.Horizontal){let diff=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,resizeLineUnderIndex=this.__resizeLines.slice(0,this.__manipulationInfo.resizeLineIndex),searchedOrientation=this.__resizeLines[this.__manipulationInfo.resizeLineIndex].orientation,allFoundedOrientation=resizeLineUnderIndex.filter(elem=>elem.orientation===searchedOrientation),indexOfFirstElem=this.__manipulationInfo.elementIndex;0===allFoundedOrientation.length?indexOfFirstElem-=1:indexOfFirstElem=allFoundedOrientation[allFoundedOrientation.length-1].chartIndex;let firstElems=this.__scopeLayout.charts.filter(elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y-this.__scopeLayout.charts[indexOfFirstElem].dimensions.height),secondElems=this.__scopeLayout.charts.filter(elem=>elem.position.y===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.y),firstElemMinHeight=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinHeight?firstElems[j].preferredSize.height>firstElemMinHeight&&(firstElemMinHeight=firstElems[j].preferredSize.height):firstElemMinHeight=firstElems[j].preferredSize.height;null===firstElemMinHeight&&(firstElemMinHeight=0);let secondElemMinHeight=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinHeight?secondElems[k].preferredSize.height>secondElemMinHeight&&(secondElemMinHeight=secondElems[k].preferredSize.height):secondElemMinHeight=secondElems[k].preferredSize.height;null===secondElemMinHeight&&(secondElemMinHeight=0);let newDiff=firstElems[0].dimensions.height+diff>=firstElemMinHeight?diff:firstElemMinHeight-firstElems[0].dimensions.height;if(secondElems.length>0&&(newDiff=secondElems[0].dimensions.height-diff>=secondElemMinHeight?newDiff:secondElems[0].dimensions.height-secondElemMinHeight),0!==newDiff){let charts=[];for(let i=0,ii=firstElems.length;i<ii;i++){let index=this.__scopeLayout.charts.indexOf(firstElems[i]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width,height:this.__scopeLayout.charts[index].dimensions.height+newDiff})}for(let l=0,ll=secondElems.length;l<ll;l++){let index=this.__scopeLayout.charts.indexOf(secondElems[l]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width,height:this.__scopeLayout.charts[index].dimensions.height-newDiff})}if(null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,resizeOverview:!1,charts:charts}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}}else{let diff=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x,firstElems=this.__scopeLayout.charts.filter(elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x),secondElems=this.__scopeLayout.charts.filter(elem=>elem.position.x===this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].position.x+this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.width),firstElemMinWidth=null;for(let j=0,jj=firstElems.length;j<jj;j++)null!==firstElemMinWidth?firstElems[j].preferredSize.width>firstElemMinWidth&&(firstElemMinWidth=firstElems[j].preferredSize.width):firstElemMinWidth=firstElems[j].preferredSize.width;null===firstElemMinWidth&&(firstElemMinWidth=0);let secondElemMinWidth=null;for(let k=0,kk=secondElems.length;k<kk;k++)null!==secondElemMinWidth?secondElems[k].preferredSize.width>secondElemMinWidth&&(secondElemMinWidth=secondElems[k].preferredSize.width):secondElemMinWidth=secondElems[k].preferredSize.width;null===secondElemMinWidth&&(secondElemMinWidth=0);let newDiff=firstElems[0].dimensions.width+diff>=firstElemMinWidth?diff:firstElemMinWidth-firstElems[0].dimensions.width;if(secondElems.length>0)newDiff=secondElems[0].dimensions.width-diff>=secondElemMinWidth?newDiff:secondElems[0].dimensions.width-secondElemMinWidth;else{let elemEndPosition=firstElems[0].position.x+firstElems[0].dimensions.width;elemEndPosition+newDiff>this.__scopeLayout.dimensions.width&&(newDiff=this.__scopeLayout.dimensions.width-elemEndPosition)}if(0!==newDiff){let charts=[];for(let i=0,ii=firstElems.length;i<ii;i++){let index=this.__scopeLayout.charts.indexOf(firstElems[i]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width+newDiff,height:this.__scopeLayout.charts[index].dimensions.height})}for(let l=0,ll=secondElems.length;l<ll;l++){let index=this.__scopeLayout.charts.indexOf(secondElems[l]);charts.push({chartIndex:index,width:this.__scopeLayout.charts[index].dimensions.width-newDiff,height:this.__scopeLayout.charts[index].dimensions.height})}if(1===charts.length&&0===secondElems.length&&charts.push({chartIndex:0,width:this.__scopeLayout.charts[0].dimensions.width-newDiff,height:this.__scopeLayout.charts[0].dimensions.height}),null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,resizeOverview:!1,charts:charts}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}}else{let diff=this.__manipulationInfo.end.y-this.__manipulationInfo.start.y,firstElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height+diff,secondElemHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-diff,firstElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].preferredSize.height,secondElemMinHeight=this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].preferredSize.height,newDiff=firstElemHeight>=firstElemMinHeight?diff:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].preferredSize.height-this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height;if(newDiff=secondElemHeight>=secondElemMinHeight?newDiff:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].preferredSize.height,0!==newDiff&&null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ResizeCharts",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,resizeOverview:!1,charts:[{chartIndex:this.__manipulationInfo.elementIndex-1,width:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.width,height:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.height+newDiff},{chartIndex:this.__manipulationInfo.elementIndex,width:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex-1].dimensions.width,height:this.__scopeLayout.charts[this.__manipulationInfo.elementIndex].dimensions.height-newDiff}]}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__resizeChartsRequestId),this.__resizeChartsRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}}else if(-1===this.__manipulationInfo.elementIndex){if(this.__overviewChart){let width=this.__manipulationInfo.end.x-this.__manipulationInfo.start.x;if(this.__manipulationInfo.isOverviewSizeChanged){if(null!==this.__subscriptionId&&this.__scopeGraphWindow&&this.__scopeGraphWindow.overviewRect)if(this.__manipulationInfo.beginOverviewRectChanging){let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width-width,xDirection=0;newWidth<5&&(newWidth=5,xDirection=width-this.__scopeGraphWindow.overviewRect.dimensions.width+5);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewRect",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,sizeChanged:{width:newWidth,changedAtBeginning:this.__manipulationInfo.beginOverviewRectChanging},xDirection:xDirection}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=TcHmi.Server.request(request,this.__getDataCallback())}else{let newWidth=this.__scopeGraphWindow.overviewRect.dimensions.width+width;newWidth<5&&(newWidth=5);let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewRect",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,sizeChanged:{width:newWidth,changedAtBeginning:this.__manipulationInfo.beginOverviewRectChanging}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}else if(null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewRect",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,xDirection:width}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewRectRequestId),this.__setOverviewRectRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}}else if(this.__scopeLayout&&this.__lineCharts){let position=this.__manipulationInfo.elementIndex,lineChart=this.__lineCharts[position];if(lineChart){this.__scopeLayout.charts[position].canvas.position.y,this.__scopeLayout.charts[position].canvas.position.x,this.__scopeLayout.charts[position].canvas.dimensions.width,this.__scopeLayout.charts[position].canvas.dimensions.height;if(this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomX||this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomXY||this.__mouseMode===TcHmiScopeControl.MouseMode.ZoomY){let context=lineChart.getCanvasZooming().getContext("2d");if(context&&context.clearRect(0,0,context.canvas.width,context.canvas.height),null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Zoom",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,zoom:{chartIndex:position,mouseMode:TcHmiScopeControl.MouseMode[this.__mouseMode],startPoint:{x:this.__manipulationInfo.start.x,y:this.__manipulationInfo.start.y},endPoint:{x:this.__manipulationInfo.end.x,y:this.__manipulationInfo.end.y}}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__zoomRequestId),this.__zoomRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}if(this.__mouseMode===TcHmiScopeControl.MouseMode.PanX||this.__mouseMode===TcHmiScopeControl.MouseMode.PanXY||this.__mouseMode===TcHmiScopeControl.MouseMode.PanY){let canvas=lineChart.getCanvasDrawing();if(canvas){let context=canvas.getContext("2d");null!==context&&context.setTransform(1,0,0,1,0,0)}if(null!==this.__subscriptionId){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Pan",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,pan:{chartIndex:position,mouseMode:TcHmiScopeControl.MouseMode[this.__mouseMode],startPoint:{x:this.__manipulationInfo.start.x,y:this.__manipulationInfo.start.y},endPoint:{x:this.__manipulationInfo.end.x,y:this.__manipulationInfo.end.y}}}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__panRequestId),this.__panRequestId=TcHmi.Server.request(request,this.__getDataCallback())}}}}this.__manipulationInfo={isManipulating:!1,start:{x:0,y:0},end:{x:0,y:0},offset:{left:0,top:0},transform:{x:0,y:0},click:!0,mousePosition:{x:0,y:0},elementIndex:-1,isOverviewSizeChanged:!1,beginOverviewRectChanging:!0,chartSizeChanged:!1,resizeLineIndex:0,touchIdentifier:0}}__showTooltip(tooltipObj){if(this.__scopeLayout&&this.__elementTooltip&&this.__elementMenuBar){this.__elementTooltip.css("visibility","visible"),this.__elementTooltipText[0].textContent=tooltipObj.displayText;let widthTooltip=this.__elementTooltip.outerWidth(),heightTooltip=this.__elementTooltip.outerHeight(),menubarHeight=this.__elementMenuBar.outerHeight(),chartPosition=this.__scopeLayout.charts[tooltipObj.chartIndex].position,overviewHeight=0;this.__showOverview&&this.__overviewChart&&(overviewHeight=this.__elementOverview.outerHeight());let middlePoint=chartPosition.x+tooltipObj.position.x-widthTooltip/2+5;tooltipObj.position.y+menubarHeight-heightTooltip+chartPosition.y-4>0?middlePoint>=0&&middlePoint+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom"),this.__elementTooltip.css({top:tooltipObj.position.y+menubarHeight-heightTooltip+chartPosition.y+overviewHeight-4,left:chartPosition.x+tooltipObj.position.x-widthTooltip/2+5})):tooltipObj.position.x+5+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+4,left:chartPosition.x+tooltipObj.position.x+4})):(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+4,left:chartPosition.x+tooltipObj.position.x-widthTooltip-4})):middlePoint>=0&&middlePoint+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top"),this.__elementTooltip.css({top:tooltipObj.position.y+12+chartPosition.y+overviewHeight+menubarHeight,left:chartPosition.x+middlePoint})):tooltipObj.position.x+4+widthTooltip<=this.getRenderedWidth()?(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+4,left:chartPosition.x+tooltipObj.position.x+4})):(this.__elementTooltipArrow.removeClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-top TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-bottom TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-left TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right").addClass("TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-tooltip-arrow-right"),this.__elementTooltip.css({top:tooltipObj.position.y-heightTooltip/2+chartPosition.y+overviewHeight+menubarHeight+4,left:chartPosition.x+tooltipObj.position.x-widthTooltip-4}));let __this=this;this.__tooltipTimeout=setTimeout((function(){__this.__elementTooltip.css("visibility","hidden")}),this.__isoToMilliSec(tooltipObj.timeoutMS))}}setChartSize(setLoadingSpinner){let width=this.__elementChartings.innerWidth(),height=this.__elementChartings.innerHeight(),request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetChartSize",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,chartWidth:width,chartHeight:height}}]};this.__loadingSpinner&&setLoadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__setChartSizeRequestId),this.__setChartSizeRequestId=TcHmi.Server.request(request,this.__setChartSizeCallback())}startRecord(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".StartRecord",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__startRecordRequestId),this.__startRecordRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__getDataCallback())}stopRecord(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".StopRecord",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__stopRecordRequestId),this.__stopRecordRequestId=TcHmi.Server.requestEx(request,{timeout:1e4},this.__getDataCallback())}startDisplay(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".StartDisplay",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__startRequestId),this.__startRequestId=TcHmi.Server.request(request,this.__getDataCallback())}stopDisplay(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".StopDisplay",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__stopRequestId),this.__stopRequestId=TcHmi.Server.request(request,this.__getDataCallback())}setDisplayWidth(displayWidth){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetDisplayWidth",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,displayWidth:this.__scopeStringToIso(displayWidth)}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),this.__displayWidthText=displayWidth,TcHmi.Server.releaseRequest(this.__displayWidthRequestId),this.__displayWidthRequestId=TcHmi.Server.request(request,this.__getDataCallback())}scroll(direction){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Scroll",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,direction:direction}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__scrollRequestId),this.__scrollRequestId=TcHmi.Server.request(request,this.__getDataCallback())}scrollBig(direction){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ScrollBig",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,direction:direction}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__scrollBigRequestId),this.__scrollBigRequestId=TcHmi.Server.request(request,this.__getDataCallback())}goTo(goTo){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Goto",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,position:this.__scopeStringToIso(goTo)}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),this.__gotoText=goTo,TcHmi.Server.releaseRequest(this.__gotoRequestId),this.__gotoRequestId=TcHmi.Server.request(request,this.__getDataCallback())}undo(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Undo",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__undoRequestId),this.__undoRequestId=TcHmi.Server.request(request,this.__getDataCallback())}redo(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Redo",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__redoRequestId),this.__redoRequestId=TcHmi.Server.request(request,this.__getDataCallback())}zoomToDefault(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ZoomToDefault",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__unzoomRequestId),this.__unzoomRequestId=TcHmi.Server.request(request,this.__getDataCallback())}zoomOutMax(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ZoomOutMax",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__zoomOutRequestId),this.__zoomOutRequestId=TcHmi.Server.request(request,this.__getDataCallback())}setOverviewMode(){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".SetOverviewMode",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,showOverview:this.__showOverview}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__setOverviewModeRequestId),this.__setOverviewModeRequestId=TcHmi.Server.request(request,this.__getDataCallback())}setMouseMode(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,TcHmiScopeControl.MouseMode);if(!tchmi_equal(convertedValue,this.__mouseMode))if(TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"MouseMode"}),this.__scopeLayout)if(convertedValue===TcHmiScopeControl.MouseMode.PanX)this.__toolBarControls.PanToggleButton&&(this.__toolBarControls.PanToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.PanX);else if(convertedValue===TcHmiScopeControl.MouseMode.PanY)this.__toolBarControls.PanYToggleButton&&(this.__toolBarControls.PanYToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.PanY);else if(convertedValue===TcHmiScopeControl.MouseMode.PanXY)this.__toolBarControls.PanXYToggleButton&&(this.__toolBarControls.PanXYToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.PanXY);else if(convertedValue===TcHmiScopeControl.MouseMode.ZoomX)this.__toolBarControls.ZoomToggleButton&&(this.__toolBarControls.ZoomToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.ZoomX);else if(convertedValue===TcHmiScopeControl.MouseMode.ZoomY)this.__toolBarControls.ZoomYToggleButton&&(this.__toolBarControls.ZoomYToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.ZoomY);else if(convertedValue===TcHmiScopeControl.MouseMode.ZoomXY)this.__toolBarControls.ZoomXYToggleButton&&(this.__toolBarControls.ZoomXYToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.ZoomXY);else{for(let controlName in this.__toolBarControls)-1!==controlName.search("ToggleButton")&&this.__toolBarControls[controlName].setToggleState("Normal");switch(TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]){case TcHmiScopeControl.ChartType.SingleBarChart:this.__toolBarControls.PanYToggleButton&&(this.__toolBarControls.PanYToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.PanY);break;case TcHmiScopeControl.ChartType.YT:case TcHmiScopeControl.ChartType.XY:case TcHmiScopeControl.ChartType.ArrayBarChart:default:this.__toolBarControls.PanXYToggleButton&&(this.__toolBarControls.PanXYToggleButton.setToggleState("Active"),this.__mouseMode=TcHmiScopeControl.MouseMode.PanXY)}}else this.__mouseMode=null}changeChannelState(id,state){let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".ChangeChannelState",writeValue:{controlName:this.__id,scopeConfig:this.__scopeConfig,channelId:id,newState:state}}]};this.__loadingSpinner&&this.__elementLoading[0].appendChild(this.__loadingSpinner),this.__enableOrDisableMenuControls("Disable",!1,!1,!1,TcHmiScopeControl.ChartType.YT),TcHmi.Server.releaseRequest(this.__changeChannelStateRequestId),this.__changeChannelStateRequestId=TcHmi.Server.request(request,this.__getDataCallback())}getMouseMode(){return this.__mouseMode}setScopeConfig(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ScopeConfig"));let resolverInfo=this.__objectResolvers.get("scopeConfig");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("scopeConfig",{resolver:resolver,watchCallback:this.__onResolverForScopeConfigWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForScopeConfigWatchCallback)})}getScopeConfig(){return this.__scopeConfig}__processScopeConfig(){TCHMI_DESIGNER?this.__scopeConfig?this.__elementTemplateRoot[0].innerHTML='<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-designer-info" style="font-style:italic;margin: 10px;">'+this.__scopeConfig.name+"::"+this.__scopeConfig.chart+"<div>":this.__elementTemplateRoot[0].innerHTML='<div class="TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-designer-info" style="font-style:italic;margin: 10px;">No configured ScopeConfig.<br>Please add a ScopeConfig to the Project and set the ScopeConfig Attribute.<div>':this.__isAttached&&this.__openWebsocket()}setServerInterval(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ServerInterval")),convertedValue!==this.__serverInterval&&(this.__serverInterval=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ServerInterval"}),this.__processServerInterval())}getServerInterval(){return this.__serverInterval}__processServerInterval(){this.__isAttached&&null!==this.__subscriptionId&&this.__unsubscribe(!0)}setServerDomain(valueNew){let convertedValue=TcHmi.ValueConverter.toString(valueNew);if(null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ServerDomain")),tchmi_equal(convertedValue,this.__serverDomain))return;this.__serverDomain;this.__serverDomain=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ServerDomain"}),this.__processServerDomain()}getServerDomain(){return this.__serverDomain}__processServerDomain(){if(this.__isAttached){if(this.__clearFullControl(),this.__scopeLayout=void 0,this.__scopeGraphData=void 0,this.__menubar=void 0,this.__legend=void 0,this.__scopeGraphWindow=null,this.__enabledButtons=TcHmiScopeControl.ButtonsEnabled.None,this.__enabledTimes=TcHmiScopeControl.TimesEnabled.None,null!==this.__configEventsDestroyEvent&&(this.__configEventsDestroyEvent(),this.__configEventsDestroyEvent=null),null!==this.__subscriptionIdOnExtensionStateChanged&&(TcHmi.Server.unsubscribe(this.__subscriptionIdOnExtensionStateChanged,null),this.__subscriptionIdOnExtensionStateChanged=null),this.__serverDomain&&(this.__configEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload",comparator:"contains",value:"configType"}],{subscription:this.__configEventCallback()})),null!==this.__scopeEventsDestroyEvent&&(this.__scopeEventsDestroyEvent(),this.__scopeEventsDestroyEvent=null),this.__serverDomain){let symbol="ListDomains::"+this.__serverDomain+"::state";this.__subscriptionIdOnExtensionStateChanged=TcHmi.Server.subscribe([{commandOptions:["SendErrorMessage","UniqueHash"],symbol:symbol}],300,this.__onExtensionStateChanged()),this.__sessionId&&this.__socketId&&(this.__isInitialized=!1,this.__scopeEventsDestroyEvent=TcHmi.Server.Events.registerConsumer([{path:"domain",comparator:"==",value:this.__serverDomain},{logic:"AND"},{path:"payload::sessionId",comparator:"==",value:this.__sessionId},{logic:"AND"},{path:"payload::socketId",comparator:"==",value:this.__socketId}],{subscription:this.__scopeEventCallback()},this.__eventRegisterDoneCallback()))}let request={requestType:"ReadWrite",commands:[{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".Init",writeValue:{controlName:this.__id}}]};TcHmi.Server.releaseRequest(this.__initRequestId),this.__initRequestId=TcHmi.Server.requestEx(request,null,this.__initCallback()),this.__openWebsocket()}}setEnableRecordControls(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("EnableRecordControls")),convertedValue!==this.__enableRecordControls&&(this.__enableRecordControls=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"EnableRecordControls"}),this.__processEnableRecordControls())}getEnableRecordControls(){return this.__enableRecordControls}__processEnableRecordControls(){if(this.__isAttached){if(this.__enableRecordControls){let controlRecord=TcHmi.Access.checkAccess(this,"controlRecord");if(null===controlRecord&&(controlRecord=!1),null===(this.__elementToolBar[0].querySelector("#"+this.__id+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StopRecordButton"))){let buttonStopControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_StopRecordButton",{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StopRecordButton","data-tchmi-is-enabled":!1},this);if(!buttonStopControl)throw new Error("Needed Button could not be instantiated");buttonStopControl.getElement().prependTo(this.__elementToolBar),buttonStopControl.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!controlRecord),this.__toolBarControls.StopRecordButton=buttonStopControl,this.__toolBarControlsArray.unshift(buttonStopControl),this.__destroyEvents.StopRecordButton=TcHmi.EventProvider.register(this.__id+"_StopRecordButton.onPressed",this.__onPressed())}if(null===(this.__elementToolBar[0].querySelector("#"+this.__id+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StartRecordButton"))){let buttonStartControl=TcHmi.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_StartRecordButton",{class:"TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-button TcHmi_Controls_Beckhoff_TcHmiScopeControl_TcHmiScopeControl-template-menu-bar-StartRecordButton","data-tchmi-is-enabled":!1},this);if(!buttonStartControl)throw new Error("Needed Button could not be instantiated");buttonStartControl.getElement().prependTo(this.__elementToolBar),buttonStartControl.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!controlRecord),this.__toolBarControls.StartRecordButton=buttonStartControl,this.__toolBarControlsArray.unshift(buttonStartControl),this.__destroyEvents.StartRecordButton=TcHmi.EventProvider.register(this.__id+"_StartRecordButton.onPressed",this.__onPressed())}}else{if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_StartRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StartRecordButton"))){let elem=this.__toolBarControls.StartRecordButton;elem&&elem.destroy();let destroyEvent=this.__destroyEvents.StartRecordButton;null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StartRecordButton}if(null!==(this.__elementToolBar[0].querySelector("#"+this.__id+"_StopRecordButton")||this.__elementMenuBarDropdown[0].querySelector("#"+this.__id+"_StopRecordButton"))){let elem=this.__toolBarControls.StopRecordButton;elem&&elem.destroy();let destroyEvent=this.__destroyEvents.StopRecordButton;null!=destroyEvent&&(destroyEvent(),destroyEvent=void 0),this.__toolBarControlsArray.splice(0,1),delete this.__toolBarControls.StopRecordButton}}this.__calcMenuButtons(),this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl.ChartType.YT)}}setChartColorSource(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,TcHmiScopeControl.ChartColorSource);null===convertedValue&&(convertedValue=TcHmi.ValueConverter.toEnum(this.getAttributeDefaultValueInternal("ChartColorSource"),TcHmiScopeControl.ChartColorSource,TcHmiScopeControl.ChartColorSource.ScopeConfig)),convertedValue!==this.__chartChartColorSource&&(this.__chartChartColorSource=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ChartColorSource"}),this.__processChartColorSource())}getChartColorSource(){return this.__chartChartColorSource}__processChartColorSource(){this.__isAttached&&this.__drawLineChart()}__processAccessConfig(){super.__processAccessConfig();let controlRecord=TcHmi.Access.checkAccess(this,"controlRecord");null===controlRecord&&(controlRecord=!1),this.__toolBarControls.StartRecordButton&&this.__toolBarControls.StartRecordButton.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!controlRecord),this.__toolBarControls.StopRecordButton&&this.__toolBarControls.StopRecordButton.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!controlRecord),this.__scopeGraphWindow&&this.__scopeLayout?this.__enableOrDisableMenuControls(this.__scopeGraphWindow.scopeState,this.__scopeGraphWindow.liveState,this.__scopeGraphWindow.undo,this.__scopeGraphWindow.redo,TcHmiScopeControl.ChartType[this.__scopeLayout.chartType]):this.__enableOrDisableMenuControls("Unknown",!1,!1,!1,TcHmiScopeControl.ChartType.YT)}}_TcHmiScopeControl_tchmiFQN={value:"TcHmi.Controls.Beckhoff.TcHmiScopeControl."+(_a=TcHmiScopeControl).name},TcHmiScopeControl_1.TcHmiScopeControl=TcHmiScopeControl,function(TcHmiScopeControl){let ConfigType,ChartColorSource,ChartType,Orientation,ButtonsEnabled,TimesEnabled,LineState,MouseMode,Direction,GraphType,FillMode;!function(ConfigType){ConfigType[ConfigType.Add=0]="Add",ConfigType[ConfigType.Change=1]="Change",ConfigType[ConfigType.Rename=2]="Rename",ConfigType[ConfigType.Delete=3]="Delete"}(ConfigType=TcHmiScopeControl.ConfigType||(TcHmiScopeControl.ConfigType={})),function(ChartColorSource){ChartColorSource[ChartColorSource.ScopeConfig=0]="ScopeConfig",ChartColorSource[ChartColorSource.Theme=1]="Theme"}(ChartColorSource=TcHmiScopeControl.ChartColorSource||(TcHmiScopeControl.ChartColorSource={})),function(ChartType){ChartType[ChartType.YT=0]="YT",ChartType[ChartType.XY=1]="XY",ChartType[ChartType.ArrayBarChart=2]="ArrayBarChart",ChartType[ChartType.SingleBarChart=3]="SingleBarChart"}(ChartType=TcHmiScopeControl.ChartType||(TcHmiScopeControl.ChartType={})),function(Orientation){Orientation[Orientation.Vertical=1]="Vertical",Orientation[Orientation.Horizontal=2]="Horizontal"}(Orientation=TcHmiScopeControl.Orientation||(TcHmiScopeControl.Orientation={})),function(ButtonsEnabled){ButtonsEnabled[ButtonsEnabled.None=0]="None",ButtonsEnabled[ButtonsEnabled.RunButton=1]="RunButton",ButtonsEnabled[ButtonsEnabled.PauseButton=2]="PauseButton",ButtonsEnabled[ButtonsEnabled.Splitter1=4]="Splitter1",ButtonsEnabled[ButtonsEnabled.DisplaywidthTextBox=8]="DisplaywidthTextBox",ButtonsEnabled[ButtonsEnabled.Splitter2=16]="Splitter2",ButtonsEnabled[ButtonsEnabled.ScrollBackBigButton=32]="ScrollBackBigButton",ButtonsEnabled[ButtonsEnabled.ScrollBackSmallButton=64]="ScrollBackSmallButton",ButtonsEnabled[ButtonsEnabled.ScrollForwardSmallButton=128]="ScrollForwardSmallButton",ButtonsEnabled[ButtonsEnabled.ScrollForwardBigButton=256]="ScrollForwardBigButton",ButtonsEnabled[ButtonsEnabled.Splitter3=512]="Splitter3",ButtonsEnabled[ButtonsEnabled.GotoTextBox=1024]="GotoTextBox",ButtonsEnabled[ButtonsEnabled.Splitter4=2048]="Splitter4",ButtonsEnabled[ButtonsEnabled.UndoButton=4096]="UndoButton",ButtonsEnabled[ButtonsEnabled.RedoButton=8192]="RedoButton",ButtonsEnabled[ButtonsEnabled.Splitter5=16384]="Splitter5",ButtonsEnabled[ButtonsEnabled.PanToggleButton=65536]="PanToggleButton",ButtonsEnabled[ButtonsEnabled.PanYToggleButton=33554432]="PanYToggleButton",ButtonsEnabled[ButtonsEnabled.PanXYToggleButton=131072]="PanXYToggleButton",ButtonsEnabled[ButtonsEnabled.ZoomToggleButton=262144]="ZoomToggleButton",ButtonsEnabled[ButtonsEnabled.ZoomYToggleButton=67108864]="ZoomYToggleButton",ButtonsEnabled[ButtonsEnabled.ZoomXYToggleButton=524288]="ZoomXYToggleButton",ButtonsEnabled[ButtonsEnabled.UnzoomButton=1048576]="UnzoomButton",ButtonsEnabled[ButtonsEnabled.ZoomOutMaxButton=2097152]="ZoomOutMaxButton",ButtonsEnabled[ButtonsEnabled.OverviewButton=4194304]="OverviewButton"}(ButtonsEnabled=TcHmiScopeControl.ButtonsEnabled||(TcHmiScopeControl.ButtonsEnabled={})),function(TimesEnabled){TimesEnabled[TimesEnabled.None=0]="None",TimesEnabled[TimesEnabled.StartTimeLabel=1]="StartTimeLabel",TimesEnabled[TimesEnabled.Splitter1=2]="Splitter1",TimesEnabled[TimesEnabled.EndTimeLabel=4]="EndTimeLabel",TimesEnabled[TimesEnabled.Splitter2=8]="Splitter2",TimesEnabled[TimesEnabled.PositionLabel=16]="PositionLabel",TimesEnabled[TimesEnabled.Splitter3=32]="Splitter3",TimesEnabled[TimesEnabled.AbsTimeLabel=64]="AbsTimeLabel",TimesEnabled[TimesEnabled.Splitter4=128]="Splitter4",TimesEnabled[TimesEnabled.DateLabel=256]="DateLabel"}(TimesEnabled=TcHmiScopeControl.TimesEnabled||(TcHmiScopeControl.TimesEnabled={})),function(LineState){LineState[LineState.None=0]="None",LineState[LineState.Normal=1]="Normal",LineState[LineState.Bold=2]="Bold",LineState[LineState.MediumBold=4]="MediumBold",LineState[LineState.Invisible=8]="Invisible",LineState[LineState.Up=16]="Up",LineState[LineState.Down=32]="Down",LineState[LineState.Dashed=256]="Dashed",LineState[LineState.DashedLine=4352]="DashedLine",LineState[LineState.MarkerArrowRight=17408]="MarkerArrowRight",LineState[LineState.MarkerArrowLeft=18432]="MarkerArrowLeft",LineState[LineState.ApplyToLine=4096]="ApplyToLine",LineState[LineState.ApplyToFillArea=8192]="ApplyToFillArea",LineState[LineState.ApplyToMark=16384]="ApplyToMark",LineState[LineState.ApplyToLineNMarkNFill=28672]="ApplyToLineNMarkNFill",LineState[LineState.InvisibleLine=4104]="InvisibleLine",LineState[LineState.InvisibleMark=16392]="InvisibleMark",LineState[LineState.InvisibleLineNMark=20488]="InvisibleLineNMark",LineState[LineState.LineUp=4112]="LineUp",LineState[LineState.LineDown=4128]="LineDown",LineState[LineState.MarkUp=16400]="MarkUp",LineState[LineState.MarkDown=16416]="MarkDown",LineState[LineState.LineNMarkUp=20496]="LineNMarkUp",LineState[LineState.LineNMarkDown=20512]="LineNMarkDown",LineState[LineState.NormalLine=4097]="NormalLine",LineState[LineState.NormalLineUp=4113]="NormalLineUp",LineState[LineState.NormalLineDown=4129]="NormalLineDown",LineState[LineState.NormalFill=8193]="NormalFill",LineState[LineState.NormalMark=16385]="NormalMark",LineState[LineState.NormalMarkUp=16401]="NormalMarkUp",LineState[LineState.NormalMarkDown=16417]="NormalMarkDown",LineState[LineState.NormalLineNMark=20481]="NormalLineNMark",LineState[LineState.NormalLineNMarkUp=20497]="NormalLineNMarkUp",LineState[LineState.NormalLineNMarkDown=20513]="NormalLineNMarkDown",LineState[LineState.BoldLine=4098]="BoldLine",LineState[LineState.BoldLineUp=4114]="BoldLineUp",LineState[LineState.BoldLineDown=4130]="BoldLineDown",LineState[LineState.BoldMark=16386]="BoldMark",LineState[LineState.BoldMarkUp=16402]="BoldMarkUp",LineState[LineState.BoldMarkDown=16418]="BoldMarkDown",LineState[LineState.BoldLineNMark=20482]="BoldLineNMark",LineState[LineState.BoldLineNMarkUp=20498]="BoldLineNMarkUp",LineState[LineState.BoldLineNMarkDown=20514]="BoldLineNMarkDown",LineState[LineState.MediumBoldLine=4100]="MediumBoldLine",LineState[LineState.MediumBoldLineUp=4116]="MediumBoldLineUp",LineState[LineState.MediumBoldLineDown=4132]="MediumBoldLineDown",LineState[LineState.MediumBoldMark=16388]="MediumBoldMark",LineState[LineState.MediumBoldMarkUp=16404]="MediumBoldMarkUp",LineState[LineState.MediumBoldMarkDown=16420]="MediumBoldMarkDown",LineState[LineState.MediumBoldLineNMark=20484]="MediumBoldLineNMark",LineState[LineState.MediumBoldLineNMarkUp=20500]="MediumBoldLineNMarkUp",LineState[LineState.MediumBoldLineNMarkDown=20516]="MediumBoldLineNMarkDown",LineState[LineState.Colored=0xffffff0000]="Colored",LineState[LineState.ColoredRed=0xff00000000]="ColoredRed",LineState[LineState.ColoredGreen=4278190080]="ColoredGreen",LineState[LineState.ColoredBlue=16711680]="ColoredBlue",LineState[LineState.Transparent=0xff0000000000]="Transparent"}(LineState=TcHmiScopeControl.LineState||(TcHmiScopeControl.LineState={})),function(MouseMode){MouseMode[MouseMode.ZoomX=0]="ZoomX",MouseMode[MouseMode.ZoomY=1]="ZoomY",MouseMode[MouseMode.ZoomXY=2]="ZoomXY",MouseMode[MouseMode.PanX=3]="PanX",MouseMode[MouseMode.PanY=4]="PanY",MouseMode[MouseMode.PanXY=5]="PanXY"}(MouseMode=TcHmiScopeControl.MouseMode||(TcHmiScopeControl.MouseMode={})),function(Direction){Direction.Forward="Forward",Direction.Reverse="Reverse"}(Direction=TcHmiScopeControl.Direction||(TcHmiScopeControl.Direction={})),function(GraphType){GraphType.Line="Line",GraphType.Stair="Stair",GraphType.Bar="Bar",GraphType.ExtendedLine="ExtendedLine"}(GraphType=TcHmiScopeControl.GraphType||(TcHmiScopeControl.GraphType={})),function(FillMode){FillMode.None="None",FillMode.FromHorizontalZero="FromHorizontalZero",FillMode.FromBottom="FromBottom",FillMode.FromTop="FromTop",FillMode.FromCenter="FromCenter",FillMode.FromSource="FromSource"}(FillMode=TcHmiScopeControl.FillMode||(TcHmiScopeControl.FillMode={}))}(TcHmiScopeControl=TcHmiScopeControl_1.TcHmiScopeControl||(TcHmiScopeControl_1.TcHmiScopeControl={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("TcHmiScopeControl","TcHmi.Controls.Beckhoff.TcHmiScopeControl",TcHmi.Controls.Beckhoff.TcHmiScopeControl.TcHmiScopeControl),function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl){let Charting;!function(Charting){class ScopeChart{constructor(elementRoot,canvasWidth,canvasHeight){this.__yAxis=[],this.__xAxis=[],this.__grid=[],this.__subgrid=[],this.__lineGraph=new Map,this.__elementRoot=elementRoot,this.__hasChanged=!1,this.__lineChanged=!1,this.__initCanvas(canvasWidth,canvasHeight)}addXAxis(xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let xAxis=new Charting.XAxis(this.__xAxis.length+1,this.__canvasFrame,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);return this.__xAxis.push(xAxis),this.__hasChanged=!0,xAxis}return null}addXAxisAtPosition(index,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let xAxis=new Charting.XAxis(this.__xAxis.length+1,this.__canvasFrame,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);this.__xAxis.splice(index,0,xAxis),this.__hasChanged=!0}}deleteXAxis(index){this.__xAxis.splice(index,1),this.setHasChanged(!0)}deleteAllXAxis(){this.__xAxis=[],this.setHasChanged(!0)}addYAxis(yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let yAxis=new Charting.YAxis(this.__yAxis.length+1,this.__canvasFrame,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);this.__yAxis.push(yAxis),this.__hasChanged=!0}}addYAxisAtPosition(index,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){if(this.__canvasFrame){let yAxis=new Charting.YAxis(this.__yAxis.length+1,this.__canvasFrame,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor);this.__yAxis.splice(index,0,yAxis),this.__hasChanged=!0}}deleteYAxis(index){this.__yAxis.splice(index,1),this.setHasChanged(!0)}deleteAllYAxis(){this.__yAxis=[],this.setHasChanged(!0)}addGrid(xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor){if(this.__canvasFrame){let grid=new Charting.Grid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor);this.__grid.push(grid),this.__hasChanged=!0}}addGridAtPosition(index,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor){if(this.__canvasFrame){let grid=new Charting.Grid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor);this.__grid.splice(index,0,grid),this.__hasChanged=!0}}deleteGrid(index){this.__grid.splice(index,1),this.setHasChanged(!0)}deleteAllGrids(){this.__grid=[],this.setHasChanged(!0)}addSubgrid(xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor){if(this.__canvasFrame){let subgrid=new Charting.Subgrid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor);this.__subgrid.push(subgrid),this.__hasChanged=!0}}addSubgridAtPosition(index,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor){if(this.__canvasFrame){let subgrid=new Charting.Subgrid(this.__canvasFrame,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor);this.__subgrid.splice(index,0,subgrid),this.__hasChanged=!0}}deleteSubgrid(index){this.__subgrid.splice(index,1),this.setHasChanged(!0)}deleteAllSubgrids(){this.__subgrid=[],this.setHasChanged(!0)}addLineGraph(graphLayout,gridSize){if(this.__canvasDrawing&&this.__lineGraph&&graphLayout){let graph=new Charting.LineGraph(this.__canvasDrawing,graphLayout,gridSize);this.__lineGraph.set(graphLayout.graphName,graph),this.__lineChanged=!0}}deleteAllLineGraphs(){this.__lineGraph.clear(),this.__lineChanged=!0}remove(){this.__canvasFrame&&this.__canvasFrame.parentNode&&this.__canvasFrame.remove(),this.__canvasDrawing&&this.__canvasDrawing.parentNode&&this.__canvasDrawing.remove(),this.__canvasMarker&&this.__canvasMarker.parentNode&&this.__canvasMarker.remove(),this.__canvasZooming&&this.__canvasZooming.parentNode&&this.__canvasZooming.remove(),this.deleteAllGrids(),this.deleteAllSubgrids(),this.deleteAllYAxis(),this.deleteAllXAxis(),this.deleteAllLineGraphs()}clear(width,height){this.__canvasFrame&&this.__contextFrame&&(this.__contextFrame.clearRect(0,0,this.__canvasFrame.width,this.__canvasFrame.height),this.__canvasFrame.width=width,this.__canvasFrame.height=height),this.__canvasDrawing&&this.__contextDrawing&&(this.__contextDrawing.setTransform(1,0,0,1,0,0),this.__contextDrawing.clearRect(0,0,this.__canvasDrawing.width,this.__canvasDrawing.height),this.__canvasDrawing.width=width,this.__canvasDrawing.height=height),this.__canvasMarker&&this.__contextMarker&&(this.__contextMarker.clearRect(0,0,this.__canvasMarker.width,this.__canvasMarker.height),this.__canvasMarker.width=width,this.__canvasMarker.height=height),this.__canvasZooming&&this.__contextZooming&&(this.__contextZooming.clearRect(0,0,this.__canvasZooming.width,this.__canvasZooming.height),this.__canvasZooming.width=width,this.__canvasZooming.height=height),this.deleteAllGrids(),this.deleteAllSubgrids(),this.deleteAllYAxis(),this.deleteAllXAxis(),this.deleteAllLineGraphs()}getYAxis(){return this.__yAxis}getYAxisAtPosition(index){return this.__yAxis[index]}getXAxis(){return this.__xAxis}getXAxisAtPosition(index){return this.__xAxis[index]}getGrid(){return this.__grid}getGridAtPosition(index){return this.__grid[index]}getSubgrid(){return this.__subgrid}getSubgridAtPosition(index){return this.__subgrid[index]}getLineGraph(){return this.__lineGraph}getLineGraphWithName(name){return this.__lineGraph.get(name)}getCanvasDrawing(){return this.__canvasDrawing}getCanvasFrame(){return this.__canvasFrame}getCanvasZooming(){return this.__canvasZooming}getCanvasMarker(){return this.__canvasMarker}getHasChanged(){return this.__hasChanged}__initCanvas(canvasWidth,canvasHeight){let canvas=document.createElement("canvas"),width=canvasWidth.toString(),height=canvasHeight.toString();canvas.setAttribute("height",height),canvas.setAttribute("width",width),canvas.setAttribute("class","tchmi-chart-canvas-frame"),canvas.setAttribute("style","position:absolute;width:100%;height:100%;"),canvas.style.backgroundColor="transparent",this.__elementRoot.append(canvas),this.__canvasFrame=canvas,this.__contextFrame=this.__canvasFrame.getContext("2d");let canvasDrawing=document.createElement("canvas");canvasDrawing.setAttribute("height",height),canvasDrawing.setAttribute("width",width),canvasDrawing.setAttribute("class","tchmi-chart-canvas-drawing"),canvasDrawing.style.backgroundColor="transparent",canvasDrawing.setAttribute("style","position:absolute;width:100%;height:100%;"),this.__elementRoot.append(canvasDrawing),this.__canvasDrawing=canvasDrawing,this.__contextDrawing=this.__canvasDrawing.getContext("2d");let canvasMarker=document.createElement("canvas");canvasMarker.setAttribute("height",height),canvasMarker.setAttribute("width",width),canvasMarker.setAttribute("class","tchmi-chart-canvas-marker"),canvasMarker.setAttribute("style","position:absolute;width:100%;height:100%;"),this.__elementRoot.append(canvasMarker),this.__canvasMarker=canvasMarker,this.__contextMarker=this.__canvasMarker.getContext("2d");let canvasZooming=document.createElement("canvas");canvasZooming.setAttribute("height",height),canvasZooming.setAttribute("width",width),canvasZooming.setAttribute("class","tchmi-chart-canvas-zooming"),canvasZooming.setAttribute("style","position:absolute;width:100%;height:100%;"),this.__elementRoot.append(canvasZooming),this.__canvasZooming=canvasZooming,this.__contextZooming=this.__canvasZooming.getContext("2d")}setHasChanged(hasChanged){this.__hasChanged=hasChanged}setLineChanged(lineChanged){this.__lineChanged=lineChanged}draw(layout,themeResourcesCanvasColor){if(this.__canvasFrame&&this.__contextFrame){if(this.__hasChanged){this.__contextFrame&&this.__contextFrame.clearRect(0,0,this.__canvasFrame.width,this.__canvasFrame.height);for(let i=0,ii=this.__xAxis.length;i<ii;i++)this.__xAxis[i].drawAxis();for(let i=0,ii=this.__yAxis.length;i<ii;i++)this.__yAxis[i].drawAxis();this.__contextFrame.fillStyle=themeResourcesCanvasColor||layout.canvas.backgroundColor,this.__contextFrame.fillRect(layout.canvas.position.x,layout.canvas.position.y,layout.canvas.dimensions.width,layout.canvas.dimensions.height);for(let i=0,ii=this.__grid.length;i<ii;i++)this.__grid[i].draw();for(let i=0,ii=this.__subgrid.length;i<ii;i++)this.__subgrid[i].draw();this.__hasChanged=!1}if(this.__lineChanged){if(this.__contextDrawing&&this.__contextDrawing.clearRect(0,0,this.__contextDrawing.canvas.width,this.__contextDrawing.canvas.height),this.__lineGraph.forEach((graph,key)=>{graph.draw()}),this.__contextDrawing){let transform=this.__contextDrawing.getTransform();this.__contextDrawing.clearRect(-transform.e,-transform.f,this.__contextDrawing.canvas.width+transform.e,layout.canvas.position.y),this.__contextDrawing.clearRect(-transform.e,this.__contextDrawing.canvas.height-transform.f,this.__contextDrawing.canvas.width+transform.e,-(this.__contextDrawing.canvas.height-layout.canvas.position.y-layout.canvas.dimensions.height)),this.__contextDrawing.clearRect(-transform.e,-transform.f,layout.canvas.position.x,this.__contextDrawing.canvas.height),this.__contextDrawing.clearRect(this.__contextDrawing.canvas.width-transform.e,-transform.f,-(this.__contextDrawing.canvas.width-layout.canvas.position.x-layout.canvas.dimensions.width),this.__contextDrawing.canvas.height)}this.__contextMarker&&this.__contextMarker.clearRect(0,0,this.__contextMarker.canvas.width,this.__contextMarker.canvas.height),this.__lineChanged=!1}}}}Charting.ScopeChart=ScopeChart,function(ScopeChart){let LineStyle;!function(LineStyle){LineStyle[LineStyle.Dotted=0]="Dotted",LineStyle[LineStyle.Dashed=1]="Dashed",LineStyle[LineStyle.Solid=2]="Solid"}(LineStyle=ScopeChart.LineStyle||(ScopeChart.LineStyle={}))}(ScopeChart=Charting.ScopeChart||(Charting.ScopeChart={}))}(Charting=TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl){let Charting;!function(Charting){Charting.Grid=class{constructor(canvas,xAxisLayout,yAxisLayout,gridSize,themeResourcesGridColor){this.__themeResourcesGridColor=null,this.__canvas=canvas,this.__context=canvas.getContext("2d"),this.__xAxisLayout=xAxisLayout,this.__yAxisLayout=yAxisLayout,this.__gridSize=gridSize,this.__themeResourcesGridColor=themeResourcesGridColor}draw(){if(this.__context&&this.__gridSize){if(this.__context.globalAlpha=1,this.__xAxisLayout&&void 0!==this.__xAxisLayout.grid&&this.__xAxisLayout.grid.visible){this.__themeResourcesGridColor?this.__context.strokeStyle=this.__themeResourcesGridColor:this.__context.strokeStyle=this.__xAxisLayout.grid.color,this.__context.lineWidth=this.__xAxisLayout.grid.lineWidth,this.__context.lineCap="butt",1!==this.__xAxisLayout.grid.lineWidth?this.__context.setLineDash([this.__xAxisLayout.grid.lineWidth,this.__xAxisLayout.grid.lineWidth]):this.__context.setLineDash([this.__xAxisLayout.grid.lineWidth,2]),this.__context.beginPath();let yStart=this.__gridSize.position.y;if(1===this.__xAxisLayout.grid.ticks)this.__context.moveTo((0|this.__gridSize.position.x)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),(yStart+(this.__xAxisLayout.grid.lineWidth/2|0)|0)-(this.__xAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo((0|this.__gridSize.position.x)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),yStart+this.__gridSize.dimensions.height-(this.__xAxisLayout.grid.lineWidth/2|0)|0);else{let xDiff=this.__gridSize.dimensions.width/(this.__xAxisLayout.grid.ticks-1),xStart=this.__gridSize.position.x;for(let i=0;i<this.__xAxisLayout.grid.ticks;i++)this.__context.moveTo((0|xStart)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),(0|yStart)-(this.__xAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo((0|xStart)+(this.__xAxisLayout.grid.lineWidth%2==0?0:.5),yStart+this.__gridSize.dimensions.height|0),xStart+=xDiff}this.__context.stroke()}if(this.__yAxisLayout&&void 0!==this.__yAxisLayout.grid&&this.__yAxisLayout.grid.visible){this.__themeResourcesGridColor?this.__context.strokeStyle=this.__themeResourcesGridColor:this.__context.strokeStyle=this.__yAxisLayout.grid.color,this.__context.lineWidth=this.__yAxisLayout.grid.lineWidth,this.__context.lineCap="butt",1!==this.__yAxisLayout.grid.lineWidth?this.__context.setLineDash([this.__yAxisLayout.grid.lineWidth,this.__yAxisLayout.grid.lineWidth]):this.__context.setLineDash([this.__yAxisLayout.grid.lineWidth,2]),this.__context.beginPath();let width=this.__gridSize.dimensions.width;if(1===this.__yAxisLayout.grid.ticks)this.__context.moveTo(0|this.__gridSize.position.x,(this.__gridSize.position.y+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo(this.__gridSize.position.x+width|0,(this.__gridSize.position.y+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5));else{let yDiff=this.__gridSize.dimensions.height/(this.__yAxisLayout.grid.ticks-1),yStart=this.__gridSize.position.y;for(let i=0;i<this.__yAxisLayout.grid.ticks;i++)this.__context.moveTo(0|this.__gridSize.position.x,(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5)),this.__context.lineTo(this.__gridSize.position.x+width|0,(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.grid.lineWidth%2==0?0:.5)),yStart-=yDiff}this.__context.stroke()}}}}}(Charting=TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl){let Charting;!function(Charting){Charting.Subgrid=class{constructor(canvas,xAxisLayout,yAxisLayout,gridSize,themeResourcesSubgridColor){this.__themeResourcesSubgridColor=null,this.__canvas=canvas,this.__context=canvas.getContext("2d"),this.__xAxisLayout=xAxisLayout,this.__yAxisLayout=yAxisLayout,this.__gridSize=gridSize,this.__themeResourcesSubgridColor=themeResourcesSubgridColor}draw(){if(this.__context&&this.__gridSize){let xBegin=this.__gridSize.position.x;this.__gridSize.position.y;if(this.__context.globalAlpha=1,this.__xAxisLayout&&this.__xAxisLayout.subGrid&&this.__xAxisLayout.grid&&this.__xAxisLayout.subGrid.visible){let xDiffSubgrid=this.__gridSize.dimensions.width/(this.__xAxisLayout.grid.ticks-1)/(this.__xAxisLayout.subGrid.ticks+1);this.__themeResourcesSubgridColor?this.__context.strokeStyle=this.__themeResourcesSubgridColor:this.__context.strokeStyle=this.__xAxisLayout.subGrid.color,this.__context.lineWidth=this.__xAxisLayout.subGrid.lineWidth,this.__context.lineCap="butt",this.__context.setLineDash([2,2]),this.__context.beginPath();let yStart=this.__gridSize.position.y,xStart=this.__gridSize.position.x+xDiffSubgrid;for(let j=0;j<this.__xAxisLayout.grid.ticks-1;j++){for(let i=0;i<this.__xAxisLayout.subGrid.ticks;i++)this.__context.moveTo((0|xStart)+(this.__xAxisLayout.subGrid.lineWidth%2==0?0:.5),yStart+(this.__xAxisLayout.grid.lineWidth/2|0)|0),this.__context.lineTo((0|xStart)+(this.__xAxisLayout.subGrid.lineWidth%2==0?0:.5),(yStart+this.__gridSize.dimensions.height+(this.__xAxisLayout.grid.lineWidth/2|0)|0)-(this.__xAxisLayout.subGrid.lineWidth%2==0?0:.5)),xStart+=xDiffSubgrid;xStart+=xDiffSubgrid}this.__context.stroke()}if(this.__yAxisLayout&&this.__yAxisLayout.subGrid&&this.__yAxisLayout.grid&&this.__yAxisLayout.subGrid.visible){let yDiffSubgrid=this.__gridSize.dimensions.height/(this.__yAxisLayout.grid.ticks-1)/(this.__yAxisLayout.subGrid.ticks+1);this.__themeResourcesSubgridColor?this.__context.strokeStyle=this.__themeResourcesSubgridColor:this.__context.strokeStyle=this.__yAxisLayout.subGrid.color,this.__context.lineWidth=this.__yAxisLayout.subGrid.lineWidth,this.__context.lineCap="butt",this.__context.setLineDash([2,2]),this.__context.beginPath();let yStart=this.__gridSize.position.y-yDiffSubgrid;for(let j=0;j<this.__yAxisLayout.grid.ticks-1;j++){for(let i=0;i<this.__yAxisLayout.subGrid.ticks;i++)this.__context.moveTo((xBegin-(this.__yAxisLayout.grid.lineWidth/2|0)|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5),(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5)),this.__context.lineTo((xBegin-(this.__yAxisLayout.grid.lineWidth/2|0)+this.__gridSize.dimensions.width|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5),(yStart+this.__gridSize.dimensions.height|0)+(this.__yAxisLayout.subGrid.lineWidth%2==0?0:.5)),yStart-=yDiffSubgrid;yStart-=yDiffSubgrid}this.__context.stroke()}}}}}(Charting=TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl){let Charting;!function(Charting){Charting.XAxis=class{constructor(id,canvas,xAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){this.__labelFontFamily=null,this.__labelFontSize=null,this.__labelFontSizeUnit=null,this.__labelFontWeight=null,this.__axisNameFontFamily=null,this.__axisNameFontSize=null,this.__axisNameFontSizeUnit=null,this.__axisNameFontWeight=null,this.__themeResourcesHeadlineColor=null,this.__themeResourcesAxisColor=null,this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__xAxisLayout=xAxisLayout,this.__themeResourcesHeadlineColor=themeResourcesHeadlineColor,this.__themeResourcesAxisColor=themeResourcesAxisColor,this.__id=id}drawAxis(){let fontFamily;const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];if(fontFamily=inheritedFontfamily||"sans-serif",this.__context&&this.__xAxisLayout){if(this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__xAxisLayout.headline&&(this.__context.font=this.__xAxisLayout.headline.fontSize+"pt "+fontFamily,this.__themeResourcesHeadlineColor?this.__context.fillStyle=this.__themeResourcesHeadlineColor:this.__context.fillStyle=this.__xAxisLayout.headline.color,this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.beginPath(),this.__context.fillText(this.__xAxisLayout.headline.label,this.__xAxisLayout.headline.position.x+this.__xAxisLayout.headline.dimensions.width/2,this.__xAxisLayout.headline.position.y+this.__xAxisLayout.headline.dimensions.height/2,this.__xAxisLayout.headline.dimensions.width),this.__context.stroke()),this.__xAxisLayout.labels&&this.__xAxisLayout.visibleTicks){for(let i=0;i<this.__xAxisLayout.labels.length;i++)this.__context.font=this.__xAxisLayout.labels[i].fontSize+"pt "+fontFamily,this.__themeResourcesAxisColor?this.__context.fillStyle=this.__themeResourcesAxisColor:this.__context.fillStyle=this.__xAxisLayout.labels[i].color,this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.beginPath(),this.__context.fillText(this.__xAxisLayout.labels[i].label,this.__xAxisLayout.labels[i].position.x+this.__xAxisLayout.labels[i].dimensions.width/2,this.__xAxisLayout.labels[i].position.y+this.__xAxisLayout.labels[i].dimensions.height/2,this.__xAxisLayout.labels[i].dimensions.width);this.__context.stroke()}if(this.__xAxisLayout.grid&&this.__xAxisLayout.subGrid&&this.__xAxisLayout.visibleTicks){let mainTicks=this.__xAxisLayout.grid.ticks,mainTickLength=5,pixelDiffBetweenMain=this.__xAxisLayout.dimensions.width/(mainTicks-1),startPoint={x:this.__xAxisLayout.position.x,y:this.__xAxisLayout.position.y+mainTickLength};this.__themeResourcesAxisColor?this.__context.strokeStyle=this.__themeResourcesAxisColor:this.__context.strokeStyle=this.__xAxisLayout.color,this.__context.lineWidth=this.__xAxisLayout.lineWidth,this.__context.setLineDash([]),this.__context.beginPath();for(let i=0;i<mainTicks;i++)0===i?(this.__context.moveTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),0|startPoint.y),this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5))):i===mainTicks?(startPoint.x=startPoint.x+pixelDiffBetweenMain,this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),0|startPoint.y)):(startPoint.x=startPoint.x+pixelDiffBetweenMain,this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),0|startPoint.y),this.__context.moveTo((0|startPoint.x)+(this.__xAxisLayout.lineWidth%2==0?0:.5),(startPoint.y-mainTickLength|0)+(this.__xAxisLayout.lineWidth%2==0?0:.5)));this.__context.stroke()}}}getId(){return this.__id}setLabelFontFamily(labelFontFamily){if(labelFontFamily)this.__labelFontFamily=labelFontFamily;else{const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];this.__labelFontFamily=inheritedFontfamily||null}}getLabelFontFamily(){return this.__labelFontFamily}setLabelFontSize(labelFontSize){if(labelFontSize)this.__labelFontSize=labelFontSize;else{const inheritedFontSize=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-size")["font-size"];this.__labelFontSize=inheritedFontSize?parseFloat(inheritedFontSize):null}}getLabelFontSize(){return this.__labelFontSize}setLabelFontSizeUnit(labelFontSizeUnit){this.__labelFontSizeUnit=labelFontSizeUnit}getLabelFontSizeUnit(){return this.__labelFontSizeUnit}setLabelFontWeight(labelFontWeight){if(labelFontWeight&&"Auto"!==labelFontWeight)this.__labelFontWeight=labelFontWeight;else{const inheritedFontWeight=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-weight")["font-weight"];this.__labelFontWeight=inheritedFontWeight||null}}getLabelFontWeight(){return this.__labelFontWeight}setAxisNameFontFamily(axisNameFontFamily){if(axisNameFontFamily)this.__axisNameFontFamily=axisNameFontFamily;else{const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];this.__axisNameFontFamily=inheritedFontfamily||null}}getAxisNameFontFamily(){return this.__axisNameFontFamily}setAxisNameFontSize(axisNameFontSize){if(axisNameFontSize)this.__axisNameFontSize=axisNameFontSize;else{const inheritedFontSize=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-size")["font-size"];this.__axisNameFontSize=inheritedFontSize?parseFloat(inheritedFontSize):null}}getAxisNameFontSize(){return this.__axisNameFontSize}setAxisNameFontSizeUnit(axisNameFontSizeUnit){this.__axisNameFontSizeUnit=axisNameFontSizeUnit}getAxisNameFontSizeUnit(){return this.__axisNameFontSizeUnit}setAxisNameFontWeight(axisNameFontWeight){if(axisNameFontWeight&&"Auto"!==axisNameFontWeight)this.__axisNameFontWeight=axisNameFontWeight;else{const inheritedFontWeight=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-weight")["font-weight"];this.__axisNameFontWeight=inheritedFontWeight||null}}getAxisNameFontWeight(){return this.__axisNameFontWeight}}}(Charting=TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl){let Charting;!function(Charting){Charting.YAxis=class{constructor(id,canvas,yAxisLayout,themeResourcesHeadlineColor,themeResourcesAxisColor){this.__labelFontFamily=null,this.__labelFontSize=null,this.__labelFontSizeUnit=null,this.__labelFontWeight=null,this.__axisNameFontFamily=null,this.__axisNameFontSize=null,this.__axisNameFontSizeUnit=null,this.__axisNameFontWeight=null,this.__themeResourcesHeadlineColor=null,this.__themeResourcesAxisColor=null,this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__yAxisLayout=yAxisLayout,this.__themeResourcesHeadlineColor=themeResourcesHeadlineColor,this.__themeResourcesAxisColor=themeResourcesAxisColor,this.__id=id}drawAxis(){let fontFamily;const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];if(fontFamily=inheritedFontfamily||"sans-serif",null!==this.__context&&this.__yAxisLayout){if(this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__yAxisLayout.headline&&(this.__context.font=this.__yAxisLayout.headline.fontSize+"pt "+fontFamily,this.__themeResourcesHeadlineColor?this.__context.fillStyle=this.__themeResourcesHeadlineColor:this.__context.fillStyle=this.__yAxisLayout.headline.color,this.__context.beginPath(),this.__context.textAlign="center",this.__context.textBaseline="middle",this.__context.translate(this.__yAxisLayout.headline.position.x+this.__yAxisLayout.headline.dimensions.width/2,this.__yAxisLayout.headline.position.y+this.__yAxisLayout.headline.dimensions.height/2),this.__context.rotate(-.5*Math.PI),this.__context.fillText(this.__yAxisLayout.headline.label,0,0),this.__context.stroke(),this.__context.setTransform(1,0,0,1,0,0)),this.__yAxisLayout.labels&&this.__yAxisLayout.visibleTicks){for(let i=0;i<this.__yAxisLayout.labels.length;i++){let lines=this.__yAxisLayout.labels[i].label.split("\n");this.__context.font=this.__yAxisLayout.labels[i].fontSize+"pt "+fontFamily,this.__themeResourcesAxisColor?this.__context.fillStyle=this.__themeResourcesAxisColor:this.__context.fillStyle=this.__yAxisLayout.labels[i].color,this.__context.textAlign="right",this.__context.textBaseline="middle",this.__context.beginPath();for(let j=0,jj=lines.length;j<jj;j++)0===j&&lines.length>1?this.__context.textBaseline="bottom":j>0&&lines.length>1&&(this.__context.textBaseline="top"),this.__context.fillText(lines[j],this.__yAxisLayout.labels[i].position.x+this.__yAxisLayout.labels[i].dimensions.width,this.__yAxisLayout.labels[i].position.y+this.__yAxisLayout.labels[i].dimensions.height/2,this.__yAxisLayout.labels[i].dimensions.width)}this.__context.stroke()}if(this.__yAxisLayout.grid&&this.__yAxisLayout.subGrid&&this.__yAxisLayout.visibleTicks){let mainTicks=this.__yAxisLayout.grid.ticks,mainTickLength=5,pixelDiffBetweenMain=this.__yAxisLayout.dimensions.height/(mainTicks-1),startPoint={x:this.__yAxisLayout.position.x,y:this.__yAxisLayout.position.y+this.__yAxisLayout.dimensions.height};this.__themeResourcesAxisColor?this.__context.strokeStyle=this.__themeResourcesAxisColor:this.__context.strokeStyle=this.__yAxisLayout.color,this.__context.lineWidth=this.__yAxisLayout.lineWidth,this.__context.setLineDash([]),this.__context.beginPath();for(let i=0;i<mainTicks;i++)0===i?(this.__context.moveTo(startPoint.x+this.__yAxisLayout.dimensions.width-mainTickLength|0,(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5))):i===mainTicks-1?(startPoint.y=startPoint.y-pixelDiffBetweenMain,this.__context.lineTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo(startPoint.x+this.__yAxisLayout.dimensions.width-mainTickLength|0,(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5))):(startPoint.y=startPoint.y-pixelDiffBetweenMain,this.__context.lineTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.lineTo(startPoint.x+this.__yAxisLayout.dimensions.width-mainTickLength|0,(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)),this.__context.moveTo((startPoint.x+this.__yAxisLayout.dimensions.width|0)+(this.__yAxisLayout.lineWidth%2==0?0:.5),(0|startPoint.y)+(this.__yAxisLayout.lineWidth%2==0?0:.5)));this.__context.stroke()}}}getId(){return this.__id}setLabelFontFamily(labelFontFamily){if(labelFontFamily)this.__labelFontFamily=labelFontFamily;else{const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];this.__labelFontFamily=inheritedFontfamily||null}}getLabelFontFamily(){return this.__labelFontFamily}setLabelFontSize(labelFontSize){if(labelFontSize)this.__labelFontSize=labelFontSize;else{const inheritedFontSize=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-size")["font-size"];this.__labelFontSize=inheritedFontSize?parseFloat(inheritedFontSize):null}}getLabelFontSize(){return this.__labelFontSize}setLabelFontSizeUnit(labelFontSizeUnit){this.__labelFontSizeUnit=labelFontSizeUnit}getLabelFontSizeUnit(){return this.__labelFontSizeUnit}setLabelFontWeight(labelFontWeight){if(labelFontWeight&&"Auto"!==labelFontWeight)this.__labelFontWeight=labelFontWeight;else{const inheritedFontWeight=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-weight")["font-weight"];this.__labelFontWeight=inheritedFontWeight||null}}getLabelFontWeight(){return this.__labelFontWeight}setAxisNameFontFamily(axisNameFontFamily){if(axisNameFontFamily)this.__axisNameFontFamily=axisNameFontFamily;else{const inheritedFontfamily=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-family")["font-family"];this.__axisNameFontFamily=inheritedFontfamily||null}}getAxisNameFontFamily(){return this.__axisNameFontFamily}setAxisNameFontSize(axisNameFontSize){if(axisNameFontSize)this.__axisNameFontSize=axisNameFontSize;else{const inheritedFontSize=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-size")["font-size"];this.__axisNameFontSize=inheritedFontSize?parseFloat(inheritedFontSize):null}}getAxisNameFontSize(){return this.__axisNameFontSize}setAxisNameFontSizeUnit(axisNameFontSizeUnit){this.__axisNameFontSizeUnit=axisNameFontSizeUnit}getAxisNameFontSizeUnit(){return this.__axisNameFontSizeUnit}setAxisNameFontWeight(axisNameFontWeight){if(axisNameFontWeight&&"Auto"!==axisNameFontWeight)this.__axisNameFontWeight=axisNameFontWeight;else{const inheritedFontWeight=TcHmi.StyleProvider.getComputedElementStyle(this.__canvas,"font-weight")["font-weight"];this.__axisNameFontWeight=inheritedFontWeight||null}}getAxisNameFontWeight(){return this.__axisNameFontWeight}}}(Charting=TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){let TcHmiScopeControl;!function(TcHmiScopeControl){let Charting;!function(Charting){Charting.LineGraph=class{constructor(canvas,graphLayout,gridSize){this.__points=null,this.__zeroPoint=null,this.__lineSeries=null,this.__canvas=canvas,this.__context=this.__canvas.getContext("2d"),this.__graphLayout=graphLayout,this.__gridSizeLayout=gridSize}draw(){if(this.__context&&this.__canvas&&this.__points&&this.__points.length>0&&this.__graphLayout){if(this.__graphLayout.lineColor&&this.__graphLayout.lineWidth)if(this.__context.strokeStyle=this.__graphLayout.lineColor,this.__context.lineWidth=this.__graphLayout.lineWidth,this.__context.lineCap="butt",this.__context.globalAlpha=1,this.__context.setLineDash([]),this.__graphLayout.graphType===TcHmiScopeControl.TcHmiScopeControl.GraphType.Bar){if(this.__zeroPoint){this.__context.beginPath();for(let i=0,ii=this.__points.length;i<ii;i++)this.__context.moveTo(this.__points[i].x,this.__zeroPoint.y),this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__context.stroke()}}else if(this.__graphLayout.graphType===TcHmiScopeControl.TcHmiScopeControl.GraphType.ExtendedLine&&this.__lineSeries){this.__context.save();let start=0,end=this.__points.length,current="";for(let i=0,ii=this.__lineSeries.length;i<ii&&!(this.__lineSeries[i].index>=this.__points.length);i++){let lineStates=this.__lineSeries[i].lineStates.filter(ls=>1===parseInt(ls[14],16)),next=0===lineStates.length?"":lineStates[0];""!==next&&next!==current&&(this.__lineSeries[i].index>start&&(end=this.__lineSeries[i].index,this.__renderLineSegment(start,end,current)),start=this.__lineSeries[i].index,current=next)}start<this.__points.length-1&&this.__renderLineSegment(start,this.__points.length-1,current)}else{this.__context.beginPath();for(let i=0,ii=this.__points.length;i<ii;i++)0===i?this.__context.moveTo(this.__points[i].x,this.__points[i].y):(this.__graphLayout.graphType===TcHmiScopeControl.TcHmiScopeControl.GraphType.Stair&&this.__context.lineTo(this.__points[i].x,this.__points[i-1].y),this.__context.lineTo(this.__points[i].x,this.__points[i].y));this.__context.stroke()}if(this.__graphLayout.fillColor&&this.__graphLayout.fillTransparency)if(this.__context.lineWidth=0,this.__context.fillStyle=this.__graphLayout.fillColor,this.__context.strokeStyle=this.__graphLayout.lineColor,this.__context.globalAlpha=this.__graphLayout.fillTransparency/255,this.__graphLayout.graphType===TcHmiScopeControl.TcHmiScopeControl.GraphType.ExtendedLine&&this.__lineSeries){this.__context.save();let start=this.__points.length-1,end=0,current="1";for(let i=this.__lineSeries.length-1,ii=0;i>=ii;i--)this.__lineSeries[i].lineStates.filter(ls=>2===parseInt(ls[14],16))&&(current=this.__lineSeries[i].lineStates.filter(ls=>2===parseInt(ls[14],16))[0],end=this.__lineSeries[i].index,this.__renderFillSegment(start,end,current),start=end);start>0&&this.__renderFillSegment(start,this.__points.length-1,current)}else if(this.__graphLayout.fillMode===TcHmiScopeControl.TcHmiScopeControl.FillMode.FromTop)this.__context.lineTo(this.__points[this.__points.length-1].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[0].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.fill();else if(this.__graphLayout.fillMode===TcHmiScopeControl.TcHmiScopeControl.FillMode.FromBottom)this.__context.lineTo(this.__points[this.__points.length-1].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[0].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.fill();else if(this.__graphLayout.fillMode===TcHmiScopeControl.TcHmiScopeControl.FillMode.FromHorizontalZero)this.__zeroPoint&&(this.__context.lineTo(this.__points[this.__points.length-1].x,this.__zeroPoint.y),this.__context.lineTo(this.__points[0].x,this.__zeroPoint.y),this.__context.fill());else if(this.__graphLayout.fillMode===TcHmiScopeControl.TcHmiScopeControl.FillMode.FromCenter){if(this.__zeroPoint)for(let i=0,ii=this.__points.length-1;i<ii;i++)this.__context.beginPath(),this.__context.moveTo(this.__points[i].x,this.__points[i].y),this.__context.lineTo(this.__points[i+1].x,this.__points[i+1].y),this.__context.lineTo(this.__zeroPoint.x,this.__zeroPoint.y),this.__context.closePath(),this.__context.fill()}else this.__graphLayout.fillMode===TcHmiScopeControl.TcHmiScopeControl.FillMode.FromSource&&(this.__context.lineTo(this.__points[0].x,this.__points[0].y),this.__context.fill("evenodd"));if(this.__graphLayout.markWidth&&this.__graphLayout.markColor)if(this.__context.strokeStyle=this.__graphLayout.markColor,this.__context.lineWidth=this.__graphLayout.markWidth,this.__context.lineCap="square",this.__context.globalAlpha=1,this.__context.setLineDash([]),this.__graphLayout.graphType===TcHmiScopeControl.TcHmiScopeControl.GraphType.ExtendedLine&&this.__lineSeries){this.__context.save();let start=0,end=this.__points.length,current="1";for(let i=0,ii=this.__lineSeries.length;i<ii;i++)this.__lineSeries[i].lineStates.filter(ls=>4===parseInt(ls[14],16))&&(this.__lineSeries[i].index>start&&(end=this.__lineSeries[i].index,0==(parseInt(current.substring(14,18),16)&TcHmiScopeControl.TcHmiScopeControl.LineState.Invisible)&&this.__renderMarkSegment(start,end-1,current)),start=this.__lineSeries[i].index,current=this.__lineSeries[i].lineStates.filter(ls=>4===parseInt(ls[14],16))[0]);start<this.__points.length&&this.__renderMarkSegment(start,this.__points.length-1,current)}else if(this.__graphLayout.marks){this.__context.beginPath();for(let i=0,ii=this.__points.length;i<ii;i++)this.__context.moveTo(this.__points[i].x,this.__points[i].y),this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__context.stroke()}if(this.__graphLayout.showStartCap&&this.__graphLayout.capSize&&this.__graphLayout.capColor){let startCapS=this.__points[this.__points.length-2],startCapE=this.__points[this.__points.length-1],dx=startCapE.x-startCapS.x,dy=startCapE.y-startCapS.y,ang=Math.atan2(dy,dx);this.__context.fillStyle=this.__graphLayout.capColor,this.__context.save(),this.__context.translate(startCapE.x,startCapE.y),this.__context.rotate(ang),this.__context.beginPath(),this.__context.moveTo(0,this.__graphLayout.capSize),this.__context.lineTo(0,-this.__graphLayout.capSize),this.__context.lineTo(this.__graphLayout.capSize,0),this.__context.fill(),this.__context.restore()}this.__graphLayout.showEndCap&&this.__graphLayout.capSize&&this.__graphLayout.capColor&&(this.__context.beginPath(),this.__context.fillStyle=this.__graphLayout.capColor,this.__context.arc(this.__points[0].x,this.__points[0].y,this.__graphLayout.capSize/2,0,2*Math.PI),this.__context.fill())}}__renderLineSegment(start,end,current){if(this.__context&&this.__points){if(this.__context.restore(),this.__context.beginPath(),this.__context.save(),0!=(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.Invisible))return;(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.BoldLine)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.BoldLine&&(this.__context.lineWidth=14.5*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.MediumBoldLine)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.MediumBoldLine&&(this.__context.lineWidth=7*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.Dashed)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.Dashed&&this.__context.setLineDash([2,5]),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.ApplyToLine)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.ApplyToLine&&0!==parseInt(current.substring(5,14),16)&&(this.__context.strokeStyle="#"+current.substring(8,14),this.__context.globalAlpha=parseInt(current.substring(6,8),16)/255);for(let i=start,ii=end;i<=ii;i++)i===start?this.__context.moveTo(this.__points[i].x,this.__points[i].y):this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__context.stroke()}}__renderMarkSegment(start,end,current){if(this.__context&&this.__points){if(this.__context.restore(),this.__context.beginPath(),this.__context.save(),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.BoldMark)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.BoldMark&&(this.__context.lineWidth=14.5*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.MediumBoldMark)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.MediumBoldMark&&(this.__context.lineWidth=7*this.__context.lineWidth),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.ApplyToMark)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.ApplyToMark&&0!==parseInt(current.substring(5,14),16)&&(this.__context.strokeStyle="#"+current.substring(8,14),this.__context.globalAlpha=parseInt(current.substring(6,8),16)/255),this.__graphLayout&&this.__graphLayout.markWidth&&this.__graphLayout.markColor){this.__context.beginPath();for(let i=start,ii=end;i<=ii;i++)this.__context.moveTo(this.__points[i].x,this.__points[i].y),this.__context.lineTo(this.__points[i].x,this.__points[i].y)}this.__context.stroke()}}__renderFillSegment(start,end,current){if(this.__context&&this.__points){this.__context.restore(),this.__context.beginPath(),this.__context.save(),(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.ApplyToFillArea)===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.ApplyToFillArea&&0!==parseInt(current.substring(5,14),16)&&(this.__context.fillStyle="#"+current.substring(8,14),this.__context.globalAlpha=parseInt(current.substring(6,8),16)/255),0!=(parseInt(current.substring(14,18),16)&Beckhoff.TcHmiScopeControl.TcHmiScopeControl.LineState.Invisible)&&(this.__context.globalAlpha=0),this.__context.moveTo(this.__points[end].x,this.__points[end].y);for(let i=end+1,ii=start;i<=ii;i++)this.__context.lineTo(this.__points[i].x,this.__points[i].y);this.__graphLayout&&(this.__graphLayout.fillMode===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.FillMode.FromTop?(this.__context.lineTo(this.__points[start].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[end].x,this.__gridSizeLayout.position.y),this.__context.lineTo(this.__points[end].x,this.__points[end].y),this.__context.fill()):this.__graphLayout.fillMode===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.FillMode.FromBottom?(this.__context.lineTo(this.__points[start].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[end].x,this.__gridSizeLayout.position.y+this.__gridSizeLayout.dimensions.height),this.__context.lineTo(this.__points[end].x,this.__points[end].y),this.__context.fill()):this.__graphLayout.fillMode===Beckhoff.TcHmiScopeControl.TcHmiScopeControl.FillMode.FromHorizontalZero&&this.__zeroPoint&&(this.__context.lineTo(this.__points[start].x,this.__zeroPoint.y),this.__context.lineTo(this.__points[end].x,this.__zeroPoint.y),this.__context.fill()))}}setPoints(points){this.__points=points}setZeroPoint(zeroPoint){this.__zeroPoint=zeroPoint}setLineSeries(lineSeries){this.__lineSeries=lineSeries}}}(Charting=TcHmiScopeControl.Charting||(TcHmiScopeControl.Charting={}))}(TcHmiScopeControl=Beckhoff.TcHmiScopeControl||(Beckhoff.TcHmiScopeControl={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={}));